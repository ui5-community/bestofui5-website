sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/Render","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/util/FocusableElements","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/util/getEffectiveScrollbarStyle","sap/ui/webc/common/thirdparty/base/ManagedStyles","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/util/PopupUtils","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/MediaRange","./generated/templates/PopupTemplate.lit","./generated/templates/PopupBlockLayerTemplate.lit","./types/PopupAccessibleRole","./popup-utils/OpenedPopupsRegistry","./generated/themes/Popup.css","./generated/themes/PopupStaticAreaStyles.css","./generated/themes/PopupGlobal.css"],function(e,t,o,s,i,a,r,l,n,u,d,p,c,f,h,b,y,m,_,g,v,w,R,E){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=F(t);s=F(s);i=F(i);a=F(a);r=F(r);l=F(l);p=F(p);b=F(b);y=F(y);m=F(m);_=F(_);g=F(g);w=F(w);R=F(R);E=F(E);function F(e){return e&&e.__esModule?e:{default:e}}var P=void 0&&(void 0).__decorate||function(e,t,o,s){var i=arguments.length,a=i<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,o):s,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,s);else for(var l=e.length-1;l>=0;l--)if(r=e[l])a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a;return i>3&&a&&Object.defineProperty(t,o,a),a};var S;const O=()=>{if(!(0,c.hasStyle)("data-ui5-popup-scroll-blocker")){(0,c.createStyle)(E.default,"data-ui5-popup-scroll-blocker")}};O();const k=new Set;let B=S=class e extends l.default{constructor(){super();this._resizeHandler=this._resize.bind(this)}onBeforeRendering(){this._blockLayerHidden=!this.isOpen()||!this.isTopModalPopup}onEnterDOM(){b.default.register(this,this._resizeHandler)}onExitDOM(){if(this.isOpen()){S.unblockPageScrolling(this);this._removeOpenedPopup()}b.default.deregister(this,this._resizeHandler)}get _displayProp(){return"block"}_resize(){this.mediaRange=y.default.getCurrentRange(y.default.RANGESETS.RANGE_4STEPS,this.getDomRef().offsetWidth)}_preventBlockLayerFocus(e){e.preventDefault()}static blockPageScrolling(e){k.add(e);if(k.size!==1){return}document.documentElement.classList.add("ui5-popup-scroll-blocker")}static unblockPageScrolling(e){k.delete(e);if(k.size!==0){return}document.documentElement.classList.remove("ui5-popup-scroll-blocker")}_scroll(e){this.fireEvent("scroll",{scrollTop:e.target.scrollTop,targetRef:e.target})}_onkeydown(e){const t=e.target===this._root&&(0,f.isTabPrevious)(e);const o=(0,f.isEnter)(e)&&!this.isOpen();if(t||o){e.preventDefault()}}_onfocusout(e){if(!e.relatedTarget){this._shouldFocusRoot=true}}_onmousedown(e){if(!(0,n.isSafari)()){this._root.removeAttribute("tabindex")}if(this.shadowRoot.contains(e.target)){this._shouldFocusRoot=true}else{this._shouldFocusRoot=false}}_onmouseup(){if(!(0,n.isSafari)()){this._root.tabIndex=-1}if(this._shouldFocusRoot){if((0,n.isChrome)()){this._root.focus()}this._shouldFocusRoot=false}}async forwardToFirst(){const e=await(0,u.getFirstFocusableElement)(this);if(e){e.focus()}else{this._root.focus()}}async forwardToLast(){const e=await(0,u.getLastFocusableElement)(this);if(e){e.focus()}else{this._root.focus()}}async applyInitialFocus(){await this.applyFocus()}async applyFocus(){await this._waitForDomRef();if(this.getRootNode()===this){return}const e=this.getRootNode().getElementById(this.initialFocus)||document.getElementById(this.initialFocus)||await(0,u.getFirstFocusableElement)(this)||this._root;if(e){if(e===this._root){e.tabIndex=-1}e.focus()}}isOpen(){return this.opened}isFocusWithin(){return(0,h.isFocusedElementWithinNode)(this._root)}async _open(e){const t=!this.fireEvent("before-open",{},true,false);if(t){return}if(this.isModal&&!this.shouldHideBackdrop){this.getStaticAreaItemDomRef();this._blockLayerHidden=false;S.blockPageScrolling(this)}this._zIndex=(0,h.getNextZIndex)();this.style.zIndex=this._zIndex?.toString()||"";this._focusedElementBeforeOpen=(0,h.getFocusedElement)();this._show();this._addOpenedPopup();this.opened=true;this.open=true;await(0,o.renderFinished)();if(!this._disableInitialFocus&&!e){await this.applyInitialFocus()}this.fireEvent("after-open",{},false,false)}_addOpenedPopup(){(0,v.addOpenedPopup)(this)}close(e=false,t=false,o=false){if(!this.opened){return}const s=!this.fireEvent("before-close",{escPressed:e},true,false);if(s){return}if(this.isModal){this._blockLayerHidden=true;S.unblockPageScrolling(this)}this.hide();this.opened=false;this.open=false;if(!t){this._removeOpenedPopup()}if(!this.preventFocusRestore&&!o){this.resetFocus()}this.fireEvent("after-close",{},false,false)}_removeOpenedPopup(){(0,v.removeOpenedPopup)(this)}resetFocus(){if(!this._focusedElementBeforeOpen){return}this._focusedElementBeforeOpen.focus();this._focusedElementBeforeOpen=null}_show(){this.style.display=this._displayProp}hide(){this.style.display="none"}get _ariaLabel(){return(0,d.getEffectiveAriaLabelText)(this)}get _root(){return this.shadowRoot.querySelector(".ui5-popup-root")}get _role(){return this.accessibleRole===g.default.None?undefined:this.accessibleRole.toLowerCase()}get _ariaModal(){return this.accessibleRole===g.default.None?undefined:"true"}get contentDOM(){return this.shadowRoot.querySelector(".ui5-popup-content")}get styles(){return{root:{},content:{},blockLayer:{zIndex:this._zIndex?this._zIndex-1:""}}}get classes(){return{root:{"ui5-popup-root":true,"ui5-content-native-scrollbars":(0,p.default)()},content:{"ui5-popup-content":true}}}};P([(0,a.default)()],B.prototype,"initialFocus",void 0);P([(0,a.default)({type:Boolean})],B.prototype,"preventFocusRestore",void 0);P([(0,a.default)({type:Boolean})],B.prototype,"open",void 0);P([(0,a.default)({type:Boolean,noAttribute:true})],B.prototype,"opened",void 0);P([(0,a.default)({defaultValue:undefined})],B.prototype,"accessibleName",void 0);P([(0,a.default)({defaultValue:""})],B.prototype,"accessibleNameRef",void 0);P([(0,a.default)({type:g.default,defaultValue:g.default.Dialog})],B.prototype,"accessibleRole",void 0);P([(0,a.default)()],B.prototype,"mediaRange",void 0);P([(0,a.default)({type:Boolean})],B.prototype,"_disableInitialFocus",void 0);P([(0,a.default)({type:Boolean})],B.prototype,"_blockLayerHidden",void 0);P([(0,a.default)({type:Boolean,noAttribute:true})],B.prototype,"isTopModalPopup",void 0);P([(0,i.default)({type:HTMLElement,default:true})],B.prototype,"content",void 0);B=S=P([(0,t.default)({renderer:r.default,styles:w.default,template:m.default,staticAreaTemplate:_.default,staticAreaStyles:R.default}),(0,s.default)("before-open"),(0,s.default)("after-open"),(0,s.default)("before-close",{escPressed:{type:Boolean}}),(0,s.default)("after-close"),(0,s.default)("scroll")],B);var I=B;e.default=I});
//# sourceMappingURL=Popup.js.map