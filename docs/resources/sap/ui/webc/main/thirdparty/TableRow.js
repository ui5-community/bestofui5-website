sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/util/getActiveElement","sap/ui/webc/common/thirdparty/base/util/TabbableElements","sap/ui/webc/common/thirdparty/base/MarkedEvents","./CheckBox","./types/TableMode","./types/TableRowType","./types/TableColumnPopinDisplay","./generated/templates/TableRowTemplate.lit","./generated/i18n/i18n-defaults","./generated/themes/TableRow.css"],function(e,t,i,s,o,n,l,a,r,u,c,d,p,f,h,b,v,m,y){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=g(t);i=g(i);s=g(s);o=g(o);n=g(n);a=g(a);u=g(u);p=g(p);f=g(f);h=g(h);b=g(b);v=g(v);y=g(y);function g(e){return e&&e.__esModule?e:{default:e}}var _=void 0&&(void 0).__decorate||function(e,t,i,s){var o=arguments.length,n=o<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s,l;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)if(l=e[a])n=(o<3?l(n):o>3?l(t,i,n):l(t,i))||n;return o>3&&n&&Object.defineProperty(t,i,n),n};var w;let E=w=class e extends t.default{constructor(){super();this.visibleCells=[];this.popinCells=[];this._tabbables=[];this._columnsInfoString="";const e=()=>{this.activate()};this._ontouchstart={handleEvent:e,passive:true}}_onmouseup(){this.deactivate()}_onkeydown(e){const t=(0,u.default)();const i=this.type===h.default.Active;const s=this.isSingleSelect;const o=s||this.isMultiSelect;const n=this._activeElementHasAttribute("ui5-table-row");const l=e.target;const a=l.classList.contains("ui5-multi-select-checkbox");const d=Array.from(this.shadowRoot.querySelectorAll("tr")||[]);const p=d.map(c.getLastTabbableElement);const f=p.pop();if((0,r.isTabNext)(e)&&t===(f||this.root)){this.fireEvent("_forward-after",{target:t})}if((0,r.isTabPrevious)(e)&&t===this.root){this.fireEvent("_forward-before",{target:t})}if((0,r.isSpace)(e)&&l.tagName.toLowerCase()==="tr"){e.preventDefault()}if(n&&!a){if((0,r.isSpace)(e)&&o||(0,r.isEnter)(e)&&s){this.fireEvent("selection-requested",{row:this})}if((0,r.isEnter)(e)&&i){this.fireEvent("row-click",{row:this});if(!s){this.activate()}}}if((0,r.isF7)(e)){e.preventDefault();this.fireEvent("f7-pressed",{row:this})}}_onkeyup(e){if((0,r.isSpace)(e)||(0,r.isEnter)(e)){this.deactivate()}}_ontouchend(){this.deactivate()}_onfocusout(){this.deactivate()}_onfocusin(e,t=false){if(t||this._activeElementHasAttribute("ui5-table-cell")){this.root.focus();this.activate()}this.fireEvent("_focused")}_onrowclick(e){const t=e.target.classList.contains("ui5-multi-select-checkbox");if((0,d.getEventMark)(e)==="button"){return}const i=this.getRootNode().activeElement;if(!this.contains(i)){this._onfocusin(e,true);this.deactivate()}if(this._activeElementHasAttribute("ui5-table-row")){if(this.isSingleSelect){this._handleSelection()}if(this.type===h.default.Active&&!t){this.fireEvent("row-click",{row:this})}}}_handleSelection(){this.fireEvent("selection-requested",{row:this})}_activeElementHasAttribute(e){return this.getRootNode().activeElement.hasAttribute(e)}get _ariaCurrent(){return this.navigated?true:undefined}activate(){if(this.type===h.default.Active){this.active=true}}deactivate(){if(this.active){this.active=false}}get shouldPopin(){return this._columnsInfo.filter(e=>e.demandPopin||!e.visible).length}get allColumnsPoppedIn(){return this._columnsInfo.every(e=>e.demandPopin&&!e.visible)}onBeforeRendering(){if(!this.shouldPopin){return}this.visibleCells=[];this.popinCells=[];if(this.cells.length===0){return}const e=this.allColumnsPoppedIn?"all-columns-popped-in":"";this._columnsInfo.forEach((t,i)=>{const s=this.cells[i];const o=t.popinDisplay===b.default.Inline;if(!s){return}if(t.visible){this.visibleCells.push(s);s.popined=false;s._popinedInline=false}else if(t.demandPopin){const i=this.popinCells.length===0?"popin-header":"";this.popinCells.push({cell:s,popinText:t.popinText,classes:`ui5-table-popin-row ${e} ${i}`,popinDisplayInline:o});s.popined=true;if(t.popinDisplay===b.default.Inline){s._popinedInline=true}}else{s.popined=false;s._popinedInline=false}});const t=this.visibleCells[this.visibleCells.length-1];if(t){t.lastInRow=true}}get visibleCellsCount(){let e=this.visibleCells.length;if(this.isMultiSelect){e+=1}return e}get ariaLabelText(){const e=this.selected?w.i18nBundle.getText(m.LIST_ITEM_SELECTED):w.i18nBundle.getText(m.LIST_ITEM_NOT_SELECTED);const t=this.isSingleSelect||this.isMultiSelect;const i=this.cells.map((e,t)=>{const i=this.getColumnTextByIdx(t);const s=e.cellContent.length?this.getCellText(e):e.ariaLabelEmptyCellText;return`${i} ${s}`}).join(" ");if(t){return`${i}. ${this._ariaPosition}. ${e}`}return`${i}. ${this._ariaPosition}`}get ariaLabelRowSelection(){return w.i18nBundle.getText(m.ARIA_LABEL_ROW_SELECTION)}get isSingleSelect(){return this.mode===f.default.SingleSelect}get isMultiSelect(){return this.mode===f.default.MultiSelect}get root(){return this.shadowRoot.querySelector(".ui5-table-row-root")}getCellText(e){const t=e.textContent;return t?this.getNormilzedTextContent(t):""}getColumnTextByIdx(e){const t=this._columnsInfo[e];if(!t){return""}return t.text?this.getNormilzedTextContent(t.text):""}getNormilzedTextContent(e){return e.replace(/[\n\r\t]/g,"").trim()}static async onDefine(){w.i18nBundle=await(0,l.getI18nBundle)("@ui5/webcomponents")}};_([(0,s.default)({type:h.default,defaultValue:h.default.Inactive})],E.prototype,"type",void 0);_([(0,s.default)({type:Boolean})],E.prototype,"selected",void 0);_([(0,s.default)({type:Boolean})],E.prototype,"navigated",void 0);_([(0,s.default)({type:f.default,defaultValue:f.default.None})],E.prototype,"mode",void 0);_([(0,s.default)({type:Boolean})],E.prototype,"active",void 0);_([(0,s.default)({type:Object,multiple:true})],E.prototype,"_columnsInfo",void 0);_([(0,s.default)({defaultValue:"-1"})],E.prototype,"_tabIndex",void 0);_([(0,s.default)({type:Boolean})],E.prototype,"_busy",void 0);_([(0,s.default)({defaultValue:"",noAttribute:true})],E.prototype,"_ariaPosition",void 0);_([(0,n.default)({type:HTMLElement,default:true,individualSlots:true})],E.prototype,"cells",void 0);E=w=_([(0,i.default)({tag:"ui5-table-row",styles:y.default,renderer:a.default,template:v.default,dependencies:[p.default]}),(0,o.default)("row-click"),(0,o.default)("_focused"),(0,o.default)("selection-requested"),(0,o.default)("f7-pressed")],E);E.define();var T=E;e.default=T});
//# sourceMappingURL=TableRow.js.map