sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","sap/ui/webc/common/thirdparty/localization/dates/CalendarDate","sap/ui/webc/common/thirdparty/localization/dates/modifyDateBy","sap/ui/webc/common/thirdparty/localization/dates/getRoundedTimestamp","sap/ui/webc/common/thirdparty/localization/dates/getTodayUTCTimestamp","sap/ui/webc/common/thirdparty/base/types/ValueState","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/Device","./types/CalendarPickersMode","sap/ui/webc/common/thirdparty/icons/appointment-2","sap/ui/webc/common/thirdparty/icons/decline","./types/HasPopup","./generated/i18n/i18n-defaults","./DateComponentBase","./Icon","./Button","./ResponsivePopover","./Calendar","./CalendarDate","./Input","./types/InputType","./generated/templates/DatePickerTemplate.lit","./generated/templates/DatePickerPopoverTemplate.lit","sap/ui/webc/common/thirdparty/localization/features/calendar/Gregorian","./generated/themes/DatePicker.css","./generated/themes/DatePickerPopover.css","./generated/themes/ResponsivePopoverCommon.css"],function(e,t,a,i,r,o,s,n,u,l,d,p,h,c,f,m,v,y,g,_,P,D,V,b,S,T,w,F,I,k,E,A,C){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=O(t);a=O(a);i=O(i);r=O(r);s=O(s);n=O(n);u=O(u);l=O(l);d=O(d);f=O(f);y=O(y);_=O(_);P=O(P);D=O(D);V=O(V);b=O(b);S=O(S);T=O(T);w=O(w);F=O(F);I=O(I);E=O(E);A=O(A);C=O(C);function O(e){return e&&e.__esModule?e:{default:e}}var R=void 0&&(void 0).__decorate||function(e,t,a,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,a):i,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,a,i);else for(var n=e.length-1;n>=0;n--)if(s=e[n])o=(r<3?s(o):r>3?s(t,a,o):s(t,a))||o;return r>3&&o&&Object.defineProperty(t,a,o),o};var N;let x=N=class e extends _.default{onResponsivePopoverAfterClose(){this._isPickerOpen=false;if((0,c.isPhone)()){this.blur()}else{this._getInput()?.focus()}}onBeforeRendering(){this.FormSupport=(0,o.getFeature)("FormSupport");["minDate","maxDate"].forEach(e=>{const t=this[e];if(!this.isValid(t)){console.warn(`Invalid value for property "${e}": ${t} is not compatible with the configured format pattern: "${this._displayFormat}"`)}});if(this.FormSupport){this.FormSupport.syncNativeHiddenInput(this)}else if(this.name){console.warn(`In order for the "name" property to have effect, you should also: import "@ui5/webcomponents/dist/features/InputElementsFormSupport.js";`)}this.value=this.normalizeValue(this.value)||this.value;this.liveValue=this.value}get _calendarSelectionMode(){return"Single"}get _calendarTimestamp(){if(this.value&&this.dateValueUTC&&this._checkValueValidity(this.value)){const e=this.dateValueUTC.getTime();return(0,u.default)(e)}return(0,l.default)(this._primaryCalendarType)}get _calendarSelectedDates(){if(this.value&&this._checkValueValidity(this.value)){return[this.value]}return[]}_onkeydown(e){if((0,h.isShow)(e)){e.preventDefault();if(this.isOpen()){if(!(0,h.isF4)(e)){this._toggleAndFocusInput()}}else{this._toggleAndFocusInput()}}if(this._getInput().isEqualNode(e.target)&&this.isOpen()&&((0,h.isTabNext)(e)||(0,h.isTabPrevious)(e)||(0,h.isF6Next)(e)||(0,h.isF6Previous)(e))){this.closePicker()}if(this.isOpen()){return}if((0,h.isEnter)(e)){if(this.FormSupport){this.FormSupport.triggerFormSubmit(this)}}else if((0,h.isPageUpShiftCtrl)(e)){e.preventDefault();this._modifyDateValue(1,"year")}else if((0,h.isPageUpShift)(e)){e.preventDefault();this._modifyDateValue(1,"month")}else if((0,h.isPageUp)(e)){e.preventDefault();this._modifyDateValue(1,"day")}else if((0,h.isPageDownShiftCtrl)(e)){e.preventDefault();this._modifyDateValue(-1,"year")}else if((0,h.isPageDownShift)(e)){e.preventDefault();this._modifyDateValue(-1,"month")}else if((0,h.isPageDown)(e)){e.preventDefault();this._modifyDateValue(-1,"day")}}_modifyDateValue(e,t,a){if(!this.dateValue){return}const i=(0,n.default)(s.default.fromLocalJSDate(this.dateValue),e,t,a,this._minDate,this._maxDate);const r=this.formatValue(i.toUTCJSDate());this._updateValueAndFireEvents(r,true,["change","value-changed"])}_updateValueAndFireEvents(e,t,a,i=true){const r=this._checkValueValidity(e);if(r&&t){e=this.normalizeValue(e)}let o=true;this.liveValue=e;const s=this.value;if(i){this._getInput().value=e;this.value=e;this._updateValueState()}a.forEach(t=>{if(!this.fireEvent(t,{value:e,valid:r},true)){o=false}});if(!o&&i){if(this.value!==s&&this.value!==this._getInput().value){return}this._getInput().value=s;this.value=s}}_updateValueState(){const e=this._checkValueValidity(this.value);if(e&&this.valueState===d.default.Error){this.valueState=d.default.None}else if(!e){this.valueState=d.default.Error}}_toggleAndFocusInput(){this.togglePicker();this._getInput().focus()}_getInput(){return this.shadowRoot.querySelector("[ui5-input]")}_onInputSubmit(){}_onInputChange(e){this._updateValueAndFireEvents(e.target.value,true,["change","value-changed"])}_onInputInput(e){this._updateValueAndFireEvents(e.target.value,false,["input"],false)}_checkValueValidity(e){if(e===""){return true}return this.isValid(e)&&this.isInValidRange(e)}_click(e){if((0,c.isPhone)()){this.responsivePopover.showAt(this);e.preventDefault()}}isValid(e=""){if(e===""){return true}return!!this.getFormat().parse(e)}isInValidRange(e=""){if(e===""){return true}const t=this._getCalendarDateFromString(e);if(!t||!this._minDate||!this._maxDate){return false}return t.valueOf()>=this._minDate.valueOf()&&t.valueOf()<=this._maxDate.valueOf()}normalizeValue(e){if(e===""){return e}return this.getFormat().format(this.getFormat().parse(e,true),true)}get _displayFormat(){return this.getFormat().oFormatOptions.pattern}get _placeholder(){return this.placeholder!==undefined?this.placeholder:this._displayFormat}get _headerTitleText(){return N.i18nBundle.getText(g.INPUT_SUGGESTIONS_TITLE)}get phone(){return(0,c.isPhone)()}get showHeader(){return this.phone}get showFooter(){return this.phone}get accInfo(){return{ariaRoledescription:this.dateAriaDescription,ariaHasPopup:y.default.Grid,ariaAutoComplete:"none",ariaRequired:this.required,ariaLabel:(0,p.getEffectiveAriaLabelText)(this)}}get openIconTitle(){return N.i18nBundle.getText(g.DATEPICKER_OPEN_ICON_TITLE)}get openIconName(){return"appointment-2"}get dateAriaDescription(){return N.i18nBundle.getText(g.DATEPICKER_DATE_DESCRIPTION)}get _shouldHideHeader(){return false}get _ariaHidden(){return(0,c.isDesktop)()}async _respPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-responsive-popover]")}_canOpenPicker(){return!this.disabled&&!this.readonly}get _calendarPickersMode(){const e=this.getFormat();const t=e.aFormatArray.map(e=>e.type.toLowerCase());if(t.includes("day")){return f.default.DAY_MONTH_YEAR}if(t.includes("month")||t.includes("monthstandalone")){return f.default.MONTH_YEAR}return f.default.YEAR}onSelectedDatesChange(e){e.preventDefault();const t=e.detail.values&&e.detail.values[0];this._updateValueAndFireEvents(t,true,["change","value-changed"]);this.closePicker()}onHeaderShowMonthPress(){this._calendarCurrentPicker="month"}onHeaderShowYearPress(){this._calendarCurrentPicker="year"}formatValue(e){return this.getFormat().format(e)}closePicker(){this.responsivePopover.close()}async openPicker(){this._isPickerOpen=true;this._calendarCurrentPicker="day";this.responsivePopover=await this._respPopover();this.responsivePopover.showAt(this)}togglePicker(){if(this.isOpen()){this.closePicker()}else if(this._canOpenPicker()){this.openPicker()}}isOpen(){return!!this._isPickerOpen}get dateValue(){return this.liveValue?this.getFormat().parse(this.liveValue):this.getFormat().parse(this.value)}get dateValueUTC(){return this.liveValue?this.getFormat().parse(this.liveValue,true):this.getFormat().parse(this.value)}get styles(){return{main:{width:"100%"}}}get type(){return w.default.Text}};R([(0,a.default)()],x.prototype,"value",void 0);R([(0,a.default)({type:d.default,defaultValue:d.default.None})],x.prototype,"valueState",void 0);R([(0,a.default)({type:Boolean})],x.prototype,"required",void 0);R([(0,a.default)({type:Boolean})],x.prototype,"disabled",void 0);R([(0,a.default)({type:Boolean})],x.prototype,"readonly",void 0);R([(0,a.default)({defaultValue:undefined})],x.prototype,"placeholder",void 0);R([(0,a.default)()],x.prototype,"name",void 0);R([(0,a.default)({type:Boolean})],x.prototype,"hideWeekNumbers",void 0);R([(0,a.default)()],x.prototype,"accessibleName",void 0);R([(0,a.default)({defaultValue:""})],x.prototype,"accessibleNameRef",void 0);R([(0,a.default)({type:Boolean,noAttribute:true})],x.prototype,"_isPickerOpen",void 0);R([(0,a.default)({type:Object})],x.prototype,"_respPopoverConfig",void 0);R([(0,a.default)({defaultValue:"day"})],x.prototype,"_calendarCurrentPicker",void 0);R([(0,i.default)({type:HTMLElement})],x.prototype,"valueStateMessage",void 0);R([(0,i.default)({type:HTMLElement})],x.prototype,"formSupport",void 0);x=N=R([(0,t.default)({tag:"ui5-date-picker",languageAware:true,template:F.default,staticAreaTemplate:I.default,styles:E.default,staticAreaStyles:[C.default,A.default],dependencies:[P.default,V.default,b.default,S.default,T.default,D.default]}),(0,r.default)("change",{detail:{value:{type:String},valid:{type:Boolean}}}),(0,r.default)("input",{detail:{value:{type:String},valid:{type:Boolean}}})],x);x.define();var B=x;e.default=B});
//# sourceMappingURL=DatePicker.js.map