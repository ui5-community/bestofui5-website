sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/Render","sap/ui/webc/common/thirdparty/base/animations/slideDown","sap/ui/webc/common/thirdparty/base/animations/slideUp","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/types/AnimationMode","sap/ui/webc/common/thirdparty/base/config/AnimationMode","sap/ui/webc/common/thirdparty/base/delegate/ItemNavigation","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/MediaRange","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/CustomElementsScope","sap/ui/webc/common/thirdparty/icons/slim-arrow-up","sap/ui/webc/common/thirdparty/icons/slim-arrow-down","./generated/i18n/i18n-defaults","./Button","./Icon","./List","./ResponsivePopover","./types/TabContainerTabsPlacement","./types/SemanticColor","./types/TabContainerBackgroundDesign","./types/TabLayout","./types/TabsOverflowMode","./generated/templates/TabContainerTemplate.lit","./generated/templates/TabContainerPopoverTemplate.lit","./generated/themes/TabContainer.css","./generated/themes/ResponsivePopoverCommon.css"],function(t,e,i,s,o,r,a,n,l,d,u,h,f,c,p,_,b,m,v,g,w,T,S,I,y,A,O,E,R,C,B,P,x,D,N){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;e=M(e);i=M(i);s=M(s);o=M(o);r=M(r);a=M(a);n=M(n);d=M(d);u=M(u);h=M(h);f=M(f);p=M(p);b=M(b);S=M(S);I=M(I);y=M(y);A=M(A);O=M(O);E=M(E);R=M(R);C=M(C);B=M(B);P=M(P);x=M(x);D=M(D);N=M(N);function M(t){return t&&t.__esModule?t:{default:t}}var L=void 0&&(void 0).__decorate||function(t,e,i,s){var o=arguments.length,r=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,i):s,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(t,e,i,s);else for(var n=t.length-1;n>=0;n--)if(a=t[n])r=(o<3?a(r):o>3?a(e,i,r):a(e,i))||r;return o>3&&r&&Object.defineProperty(e,i,r),r};var k;const W=[];const F=[];const V=5;let H=k=class t extends e.default{static registerTabStyles(t){W.push(t)}static registerStaticAreaTabStyles(t){F.push(t)}constructor(){super();this._handleResizeBound=this._handleResize.bind(this);this._itemNavigation=new p.default(this,{getItemsCallback:()=>this._getFocusableRefs(),skipItemsSize:V})}onBeforeRendering(){this._allItemsAndSubItems=this._getAllSubItems(this.items);if(!this._allItemsAndSubItems.length){return}const t=this._allItemsAndSubItems.filter(t=>t.selected);if(t.length){this._selectedTab._selected=false;this._selectedTab=t[0]}else{this._selectedTab=this._allItemsAndSubItems[0];this._selectedTab._selected=true}this._setItemsPrivateProperties(this.items);if(!this._animationRunning){this._contentCollapsed=this.collapsed}if(this.showOverflow){console.warn(`The "show-overflow" property is deprecated and will be removed in a future release.`)}}onAfterRendering(){if(!this.items.length){return}this._setItemsForStrip();if(!this.shadowRoot.contains(document.activeElement)){const t=this._getRootTab(this._selectedTab);this._itemNavigation.setCurrentItem(t)}}onEnterDOM(){n.default.register(this._getHeader(),this._handleResizeBound)}onExitDOM(){n.default.deregister(this._getHeader(),this._handleResizeBound)}_handleResize(){if(this.responsivePopover&&this.responsivePopover.opened){this.responsivePopover.close()}this._width=this.offsetWidth;this._updateMediaRange(this._width)}_updateMediaRange(t){this.mediaRange=b.default.getCurrentRange(b.default.RANGESETS.RANGE_4STEPS,t)}_setItemsPrivateProperties(t){const e=t.filter(t=>{t._getElementInStrip=()=>this.getDomRef().querySelector(`#${t._id}`);return!t.isSeparator});e.forEach((e,i,s)=>{e._isInline=this.tabLayout===C.default.Inline;e._mixedMode=this.mixedMode;e._posinset=i+1;e._setsize=s.length;e._realTab=this._selectedTab;e._isTopLevelTab=t.some(t=>t===e);z(t,t=>{t._realTab=e._realTab})})}_onHeaderFocusin(t){const e=U(t.target);if(e){this._itemNavigation.setCurrentItem(e._realTab)}}async _onTabStripClick(t){const e=U(t.target);if(!e||e._realTab.disabled){return}t.stopPropagation();t.preventDefault();if(t.target.hasAttribute("ui5-button")){this._onTabExpandButtonClick(t);return}if(!e._realTab._hasOwnContent&&e._realTab.tabs.length){this._overflowItems=e._realTab.subTabs;this._addStyleIndent(this._overflowItems);this.responsivePopover=await this._respPopover();if(this.responsivePopover.opened){this.responsivePopover.close()}else{this._setPopoverInitialFocus()}this.responsivePopover.showAt(e._realTab.getTabInStripDomRef());return}this._onHeaderItemSelect(e)}async _onTabExpandButtonClick(t){t.stopPropagation();t.preventDefault();let e=t.target;let i=e.tab;if(i){i.focus()}if(t.type==="keydown"&&!t.target._realTab.isSingleClickArea){e=t.target.querySelectorAll(".ui5-tab-expand-button")[0];i=t.target._realTab}if(!i){this._onHeaderItemSelect(e.parentElement);return}this._overflowItems=i.subTabs;this._addStyleIndent(this._overflowItems);this.responsivePopover=await this._respPopover();if(this.responsivePopover.isOpen()){this.responsivePopover.close()}else{this._setPopoverInitialFocus()}this.responsivePopover.showAt(e)}_setPopoverInitialFocus(){const t=this._getSelectedTabInOverflow();const e=t||this._getFirstFocusableItemInOverflow();this.responsivePopover.initialFocus=`${e._realTab._id}-li`}_getSelectedTabInOverflow(){return this.responsivePopover.content[0].items.find(t=>t._realTab&&t._realTab.selected)}_getFirstFocusableItemInOverflow(){return this.responsivePopover.content[0].items.find(t=>t.classList.contains("ui5-tab-overflow-item"))}_onTabStripKeyDown(t){const e=U(t.target);if(!e||e._realTab.disabled){return}if((0,_.isEnter)(t)){if(e._realTab.isSingleClickArea){this._onTabStripClick(t)}else{this._onHeaderItemSelect(e)}}if((0,_.isSpace)(t)){t.preventDefault()}if((0,_.isDown)(t)||(0,_.isUp)(t)){if(e._realTab.requiresExpandButton){this._onTabExpandButtonClick(t)}if(e._realTab.isSingleClickArea){this._onTabStripClick(t)}}}_onTabStripKeyUp(t){const e=U(t.target);if(!e||e._realTab.disabled){return}if((0,_.isSpace)(t)){t.preventDefault();if(e._realTab.isSingleClickArea){this._onTabStripClick(t)}else{this._onHeaderItemSelect(e)}}}_onHeaderItemSelect(t){if(!t.hasAttribute("disabled")){this._onItemSelect(t.id)}}async _onOverflowListItemClick(t){t.preventDefault();this._onItemSelect(t.detail.item.id.slice(0,-3));this.responsivePopover.close();await(0,l.renderFinished)();const e=this._getRootTab(this._selectedTab);e.getTabInStripDomRef().focus()}get allItems(){return this._getAllSubItems(this.items)}_getAllSubItems(t,e=[],i=1){t.forEach(t=>{if(t.hasAttribute("ui5-tab")||t.hasAttribute("ui5-tab-separator")){t._level=i;e.push(t);if(t.subTabs){this._getAllSubItems(t.subTabs,e,i+1)}}});return e}_onItemSelect(t){const e=this._selectedTab;const i=this._allItemsAndSubItems.findIndex(e=>e.__id===t);const s=this._allItemsAndSubItems[i];const o=this.selectTab(s,i);if(!o){return}this._allItemsAndSubItems.forEach((t,e)=>{const s=i===e;t.selected=s;if(t._selected){t._selected=false}});if(this.fixed){return}if(!this.shouldAnimate){this.toggle(s,e)}else{this.toggleAnimated(s,e)}}async toggleAnimated(t,e){const i=this.shadowRoot.querySelector(".ui5-tc__content");let s=null;this._animationRunning=true;if(t===e){this.collapsed=!this.collapsed;s=this.collapsed?this.slideContentUp(i):this.slideContentDown(i)}else{s=this.collapsed?this.slideContentDown(i):Promise.resolve();this.collapsed=false}await s;this._contentCollapsed=this.collapsed;this._animationRunning=false}toggle(t,e){if(t===e){this.collapsed=!this.collapsed}else{this.collapsed=false}}selectTab(t,e){if(!this.fireEvent("tab-select",{tab:t,tabIndex:e},true)){return false}this._selectedTab=t;return true}slideContentDown(t){return(0,d.default)(t).promise()}slideContentUp(t){return(0,u.default)(t).promise()}async _onOverflowClick(t){if(t.target.classList.contains("ui5-tc__overflow")){return}const e=t.currentTarget;const i=e.classList.contains("ui5-tc__overflow--end");const s=i?"end-overflow":"start-overflow";this._overflowItems=this.items.filter(t=>{const e=t.getTabInStripDomRef();return e&&e.hasAttribute(s)});this._addStyleIndent(this._overflowItems);let o;if(i){o=this.overflowButton[0]||this._getEndOverflowBtnDOM()}else{o=this.startOverflowButton[0]||this._getStartOverflowBtnDOM()}this.responsivePopover=await this._respPopover();if(this.responsivePopover.opened){this.responsivePopover.close()}else{this._setPopoverInitialFocus();this.responsivePopover.showAt(o)}}_addStyleIndent(t){const e=this._getAllSubItems(t).filter(t=>!t.isSeparator).some(t=>t.design!==E.default.Default&&t.design!==E.default.Neutral);z(t,t=>{let i=t._level-1;if(t.isSeparator){i+=1}t._style={[(0,v.getScopedVarName)("--_ui5-tab-indentation-level")]:i,[(0,v.getScopedVarName)("--_ui5-tab-extra-indent")]:e?1:null}})}async _onOverflowKeyDown(t){const e=t.currentTarget;const i=e.classList.contains("ui5-tc__overflow--end");const s=e.classList.contains("ui5-tc__overflow--start");if((0,_.isDown)(t)||s&&(0,_.isLeft)(t)||i&&(0,_.isRight)(t)){t.stopPropagation();t.preventDefault();await this._onOverflowClick(t)}}_setItemsForStrip(){const t=this._getTabStrip();let e=0;if(!this._selectedTab){return}const i=this.items.map(t=>t.getTabInStripDomRef());this._getStartOverflow().setAttribute("hidden","");this._getEndOverflow().setAttribute("hidden","");for(let t=0;t<i.length;t++){i[t].removeAttribute("hidden");i[t].removeAttribute("start-overflow");i[t].removeAttribute("end-overflow")}i.forEach(t=>{e+=this._getItemWidth(t)});const s=t.offsetWidth<e;if(!s){return}if(this.isModeStartAndEnd){this._updateStartAndEndOverflow(i);this._updateOverflowCounters()}else{this._updateEndOverflow(i)}}_getRootTab(t){while(t.hasAttribute("ui5-tab")){if(t.parentElement.hasAttribute("ui5-tabcontainer")){break}t=t.parentElement}return t}_updateEndOverflow(t){this._getEndOverflow().removeAttribute("hidden");const e=this._getRootTab(this._selectedTab);const i=e.getTabInStripDomRef();const s=this._getTabStrip().offsetWidth;const o=this._getSelectedItemIndexAndWidth(t,i);const r=this._findLastVisibleItem(t,s,o.width);for(let e=r+1;e<t.length;e++){t[e].setAttribute("hidden","");t[e].setAttribute("end-overflow","")}this._endOverflowText=this.overflowButtonText}_updateStartAndEndOverflow(t){let e=this._getTabStrip().offsetWidth;const i=this._getRootTab(this._selectedTab);const s=i.getTabInStripDomRef();const o=this._getSelectedItemIndexAndWidth(t,s);const r=this._hasStartOverflow(e,t,o);const a=this._hasEndOverflow(e,t,o);let n;let l;if(!r){this._getEndOverflow().removeAttribute("hidden");e=this._getTabStrip().offsetWidth;l=this._findLastVisibleItem(t,e,o.width);for(let e=l+1;e<t.length;e++){t[e].setAttribute("hidden","");t[e].setAttribute("end-overflow","")}return}if(!a){this._getStartOverflow().removeAttribute("hidden");e=this._getTabStrip().offsetWidth;n=this._findFirstVisibleItem(t,e,o.width);for(let e=n-1;e>=0;e--){t[e].setAttribute("hidden","");t[e].setAttribute("start-overflow","")}return}this._getStartOverflow().removeAttribute("hidden");this._getEndOverflow().removeAttribute("hidden");e=this._getTabStrip().offsetWidth;n=this._findFirstVisibleItem(t,e,o.width,o.index-1);l=this._findLastVisibleItem(t,e,o.width,n);for(let e=n-1;e>=0;e--){t[e].setAttribute("hidden","");t[e].setAttribute("start-overflow","")}for(let e=l+1;e<t.length;e++){t[e].setAttribute("hidden","");t[e].setAttribute("end-overflow","")}}_hasStartOverflow(t,e,i){if(i.index===0){return false}let s=0;for(let t=i.index-1;t>=0;t--){s+=this._getItemWidth(e[t])}let o=t<s+i.width;if(!o){this._getEndOverflow().removeAttribute("hidden");t=this._getTabStrip().offsetWidth;o=t<s+i.width;this._getEndOverflow().setAttribute("hidden","")}return o}_hasEndOverflow(t,e,i){if(i.index>=e.length){return false}let s=0;for(let t=i.index;t<e.length;t++){s+=this._getItemWidth(e[t])}let o=t<s+i.width;if(!o){this._getStartOverflow().removeAttribute("hidden");t=this._getTabStrip().offsetWidth;o=t<s+i.width;this._getStartOverflow().setAttribute("hidden","")}return o}_getItemWidth(t){const e=window.getComputedStyle(t);const i=Number.parseInt(e.marginLeft)+Number.parseInt(e.marginRight);return t.offsetWidth+i}_getSelectedItemIndexAndWidth(t,e){let i=t.indexOf(e);let s=e.offsetWidth;let o;if(t[i-1]&&t[i-1].isSeparator){o=t[i-1];s+=this._getItemWidth(o)}t.splice(i,1);if(o){t.splice(i-1,1);i--}return{index:i,width:s}}_findFirstVisibleItem(t,e,i,s){if(s===undefined){s=t.length-1}let o=s+1;for(let r=s;r>=0;r--){const s=this._getItemWidth(t[r]);if(e<i+s){break}i+=s;o=r}return o}_findLastVisibleItem(t,e,i,s=0){let o=s-1;let r=s;for(;r<t.length;r++){const s=this._getItemWidth(t[r]);if(e<i+s){break}i+=s;o=r}const a=t[r-1];if(a&&a.isSeparator){o-=1}return o}get isModeStartAndEnd(){return this.tabsOverflowMode===B.default.StartAndEnd}_updateOverflowCounters(){let t=0;let e=0;this._getTabs().map(t=>t.getTabInStripDomRef()).forEach(i=>{if(i.hasAttribute("start-overflow")){t++}if(i.hasAttribute("end-overflow")){e++}});this._startOverflowText=`+${t}`;this._endOverflowText=`+${e}`}_getFocusableRefs(){if(!this.getDomRef()){return[]}const t=[];if(!this._getStartOverflow().hasAttribute("hidden")){t.push(this.startOverflowButton[0]||this._getStartOverflowBtnDOM())}this._getTabs().forEach(e=>{const i=e.getTabInStripDomRef();const s=i&&!i.hasAttribute("hidden");if(s){t.push(e)}});if(!this._getEndOverflow().hasAttribute("hidden")){t.push(this.overflowButton[0]||this._getEndOverflowBtnDOM())}return t}_getHeader(){return this.shadowRoot.querySelector(`#${this._id}-header`)}_getTabs(){return this.items.filter(t=>!t.isSeparator)}get hasSubTabs(){const t=this._getTabs();for(let e=0;e<t.length;e++){if(t[e].subTabs.length>0){return true}}return false}_getTabStrip(){return this.shadowRoot.querySelector(`#${this._id}-tabStrip`)}_getStartOverflow(){return this.shadowRoot.querySelector(".ui5-tc__overflow--start")}_getEndOverflow(){return this.shadowRoot.querySelector(".ui5-tc__overflow--end")}_getStartOverflowBtnDOM(){return this._getStartOverflow().querySelector("[ui5-button]")}_getEndOverflowBtnDOM(){return this._getEndOverflow().querySelector("[ui5-button]")}async _respPopover(){const t=await this.getStaticAreaItemDomRef();return t.querySelector(`#${this._id}-overflowMenu`)}async _closeRespPopover(){this.responsivePopover=await this._respPopover();this.responsivePopover.close()}get classes(){return{root:{"ui5-tc-root":true,"ui5-tc--textOnly":this.textOnly,"ui5-tc--withAdditionalText":this.withAdditionalText,"ui5-tc--standardTabLayout":this.standardTabLayout},header:{"ui5-tc__header":true},tabStrip:{"ui5-tc__tabStrip":true},separator:{"ui5-tc__separator":true},content:{"ui5-tc__content":true,"ui5-tc__content--collapsed":this._contentCollapsed}}}get mixedMode(){return this.items.some(t=>t.icon)&&this.items.some(t=>t.text)}get textOnly(){return this.items.every(t=>!t.icon)}get withAdditionalText(){return this.items.some(t=>!!t.additionalText)}get standardTabLayout(){return this.tabLayout===C.default.Standard}get previousIconACCName(){return k.i18nBundle.getText(T.TABCONTAINER_PREVIOUS_ICON_ACC_NAME)}get nextIconACCName(){return k.i18nBundle.getText(T.TABCONTAINER_NEXT_ICON_ACC_NAME)}get overflowMenuTitle(){return k.i18nBundle.getText(T.TABCONTAINER_OVERFLOW_MENU_TITLE)}get tabsAtTheBottom(){return this.tabsPlacement===O.default.Bottom}get overflowMenuIcon(){return this.tabsAtTheBottom?"slim-arrow-up":"slim-arrow-down"}get overflowButtonText(){return k.i18nBundle.getText(T.TABCONTAINER_END_OVERFLOW)}get popoverCancelButtonText(){return k.i18nBundle.getText(T.TABCONTAINER_POPOVER_CANCEL_BUTTON)}get accInvisibleText(){return k.i18nBundle.getText(T.TABCONTAINER_SUBTABS_DESCRIPTION)}get tablistAriaDescribedById(){return this.hasSubTabs?`${this._id}-invisibleText`:undefined}get shouldAnimate(){return(0,c.getAnimationMode)()!==f.default.None}static async onDefine(){k.i18nBundle=await(0,m.getI18nBundle)("@ui5/webcomponents")}};L([(0,o.default)({type:Boolean})],H.prototype,"fixed",void 0);L([(0,o.default)({type:Boolean})],H.prototype,"collapsed",void 0);L([(0,o.default)({type:Boolean})],H.prototype,"showOverflow",void 0);L([(0,o.default)({type:C.default,defaultValue:C.default.Standard})],H.prototype,"tabLayout",void 0);L([(0,o.default)({type:B.default,defaultValue:B.default.End})],H.prototype,"tabsOverflowMode",void 0);L([(0,o.default)({type:R.default,defaultValue:R.default.Solid})],H.prototype,"headerBackgroundDesign",void 0);L([(0,o.default)({type:R.default,defaultValue:R.default.Solid})],H.prototype,"contentBackgroundDesign",void 0);L([(0,o.default)({type:O.default,defaultValue:O.default.Top})],H.prototype,"tabsPlacement",void 0);L([(0,o.default)()],H.prototype,"mediaRange",void 0);L([(0,o.default)({type:Object})],H.prototype,"_selectedTab",void 0);L([(0,o.default)({type:Boolean,noAttribute:true})],H.prototype,"_animationRunning",void 0);L([(0,o.default)({type:Boolean,noAttribute:true})],H.prototype,"_contentCollapsed",void 0);L([(0,o.default)({noAttribute:true,defaultValue:"0"})],H.prototype,"_startOverflowText",void 0);L([(0,o.default)({noAttribute:true,defaultValue:"More"})],H.prototype,"_endOverflowText",void 0);L([(0,o.default)({type:Object,multiple:true})],H.prototype,"_overflowItems",void 0);L([(0,o.default)({validator:h.default,noAttribute:true})],H.prototype,"_width",void 0);L([(0,r.default)({default:true,type:HTMLElement,individualSlots:true,invalidateOnChildChange:{properties:true,slots:false}})],H.prototype,"items",void 0);L([(0,r.default)()],H.prototype,"overflowButton",void 0);L([(0,r.default)()],H.prototype,"startOverflowButton",void 0);H=k=L([(0,i.default)({tag:"ui5-tabcontainer",languageAware:true,fastNavigation:true,styles:[W,D.default],staticAreaStyles:[N.default,F],renderer:a.default,template:P.default,staticAreaTemplate:x.default,dependencies:[S.default,I.default,y.default,A.default]}),(0,s.default)("tab-select",{detail:{tab:{type:HTMLElement},tabIndex:{type:Number}}})],H);const q=t=>t.localName==="div"&&t.getAttribute("role")==="tab";const U=t=>{while(t){if(q(t)){return t}t=t.parentElement}return false};const z=(t,e)=>{[...t].forEach(t=>{e(t);if(t.subTabs){z(t.subTabs,e)}})};H.define();var $=H;t.default=$});
//# sourceMappingURL=TabContainer.js.map