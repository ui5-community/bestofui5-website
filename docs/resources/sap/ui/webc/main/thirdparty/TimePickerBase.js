sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/locale/getLocale","sap/ui/webc/common/thirdparty/base/types/ValueState","sap/ui/webc/common/thirdparty/localization/features/calendar/Gregorian","sap/ui/webc/common/thirdparty/localization/DateFormat","sap/ui/webc/common/thirdparty/base/asset-registries/LocaleData","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/icons/time-entry-request","./Icon","./Popover","./ResponsivePopover","./generated/templates/TimePickerTemplate.lit","./generated/templates/TimePickerPopoverTemplate.lit","./Input","./Button","./TimeSelectionClocks","./TimeSelectionInputs","./generated/i18n/i18n-defaults","./generated/themes/TimePicker.css","./generated/themes/TimePickerPopover.css","./generated/themes/Popover.css","./generated/themes/ResponsivePopoverCommon.css"],function(e,t,i,a,s,o,n,r,u,l,p,c,d,h,f,v,m,g,P,_,y,I,b,w,V,O,S,D,k,B){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;i=A(i);a=A(a);s=A(s);o=A(o);n=A(n);r=A(r);l=A(l);p=A(p);d=A(d);m=A(m);g=A(g);P=A(P);_=A(_);y=A(y);I=A(I);b=A(b);w=A(w);V=A(V);S=A(S);D=A(D);k=A(k);B=A(B);function A(e){return e&&e.__esModule?e:{default:e}}var T=void 0&&(void 0).__decorate||function(e,t,i,a){var s=arguments.length,o=s<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,i):a,n;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,i,a);else for(var r=e.length-1;r>=0;r--)if(n=e[r])o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o;return s>3&&o&&Object.defineProperty(t,i,o),o};var F;let E=F=class e extends i.default{static async onDefine(){[F.i18nBundle]=await Promise.all([(0,u.getI18nBundle)("@ui5/webcomponents"),(0,h.fetchCldr)((0,l.default)().getLanguage(),(0,l.default)().getRegion(),(0,l.default)().getScript())])}constructor(){super()}get _placeholder(){return undefined}get _formatPattern(){return undefined}get _effectiveValue(){return this.value}get _timeSelectionValue(){return this.tempValue}get _isPhone(){return(0,t.isPhone)()}onTimeSelectionChange(e){this.tempValue=e.detail.value}async openPicker(){this.tempValue=this.value&&this.isValid(this.value)?this.value:this.getFormat().format(new Date);const e=await this._getPopover();e.showAt(this)}async closePicker(){const e=await this._getPopover();e.close();this._isPickerOpen=false}togglePicker(){if(this.isOpen()){this.closePicker()}else if(this._canOpenPicker()){this.openPicker()}}isOpen(){return!!this._isPickerOpen}submitPickers(){this._updateValueAndFireEvents(this.tempValue,true,["change","value-changed"]);this.closePicker()}onResponsivePopoverAfterClose(){this._isPickerOpen=false}async onResponsivePopoverAfterOpen(){this._isPickerOpen=true;const e=await this._getPopover();e.querySelector("[ui5-time-selection-clocks]")._focusFirstButton()}async openInputsPopover(){this.tempValue=this.value&&this.isValid(this.value)?this.value:this.getFormat().format(new Date);const e=await this._getInputsPopover();e.showAt(this);this._isInputsPopoverOpen=true}async closeInputsPopover(){const e=await this._getInputsPopover();e.close()}toggleInputsPopover(){if(this.isInputsPopoverOpen()){this.closeInputsPopover()}else if(this._canOpenInputsPopover()){this.openInputsPopover()}}isInputsPopoverOpen(){return!!this._isInputsPopoverOpen}submitInputsPopover(){this._updateValueAndFireEvents(this.tempValue,true,["change","value-changed"]);this.closeInputsPopover()}async onInputsPopoverAfterOpen(){const e=await this._getInputsPopover();e.querySelector("[ui5-time-selection-inputs]")._addNumericAttributes()}onInputsPopoverAfterClose(){this._isInputsPopoverOpen=false}async _handleInputClick(e){const t=e.target;if(this._isPickerOpen){return}if(this._isPhone&&t&&!t.hasAttribute("ui5-icon")){this.toggleInputsPopover()}const i=await this._getInputField();if(i){i.select()}}_updateValueAndFireEvents(e,t,i){if(e===this.value){return}const a=this.isValid(e);if(e!==undefined&&a&&t){e=this.normalizeValue(e)}if(!i.includes("input")){this.value="";this.value=e}this.tempValue=e;this._updateValueState();i.forEach(t=>{this.fireEvent(t,{value:e,valid:a})})}_updateValueState(){const e=this.isValid(this.value);if(!e){this.valueState=p.default.Error}else if(e&&this.valueState===p.default.Error){this.valueState=p.default.None}}_handleInputChange(e){const t=e.target;this._updateValueAndFireEvents(t.value,true,["change","value-changed"])}_handleInputLiveChange(e){const t=e.target;this._updateValueAndFireEvents(t.value,false,["input"])}_canOpenPicker(){return!this.disabled&&!this.readonly}_canOpenInputsPopover(){return!this.disabled&&this._isPhone}async _getPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-responsive-popover]")}async _getInputsPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-popover]")}_getInput(){return this.shadowRoot.querySelector("[ui5-input]")}_getInputField(){const e=this._getInput();return e&&e.getInputDOMRef()}_onkeydown(e){if(this._isPhone&&!this.isInputsPopoverOpen()){e.preventDefault()}if((0,f.isShow)(e)){e.preventDefault();this.togglePicker()}const t=e.target;if(this._getInput().isEqualNode(t)&&this.isOpen()&&((0,f.isTabNext)(e)||(0,f.isTabPrevious)(e)||(0,f.isF6Next)(e)||(0,f.isF6Previous)(e))){this.closePicker()}if(this.isOpen()){return}if((0,f.isPageUpShiftCtrl)(e)){e.preventDefault();this._modifyValueBy(1,"second")}else if((0,f.isPageUpShift)(e)){e.preventDefault();this._modifyValueBy(1,"minute")}else if((0,f.isPageUp)(e)){e.preventDefault();this._modifyValueBy(1,"hour")}else if((0,f.isPageDownShiftCtrl)(e)){e.preventDefault();this._modifyValueBy(-1,"second")}else if((0,f.isPageDownShift)(e)){e.preventDefault();this._modifyValueBy(-1,"minute")}else if((0,f.isPageDown)(e)){e.preventDefault();this._modifyValueBy(-1,"hour")}}get _isPattern(){return this._formatPattern!=="medium"&&this._formatPattern!=="short"&&this._formatPattern!=="long"}getFormat(){let e;if(this._isPattern){e=d.default.getDateInstance({pattern:this._formatPattern})}else{e=d.default.getDateInstance({style:this._formatPattern})}return e}formatValue(e){return this.getFormat().format(e)}isValid(e){if(e===""){return true}return!!this.getFormat().parse(e)}normalizeValue(e){if(e===""){return e}return this.getFormat().format(this.getFormat().parse(e))}_modifyValueBy(e,t){const i=this.getFormat().parse(this._effectiveValue);if(!i){return}if(t==="hour"){i.setHours(i.getHours()+e)}else if(t==="minute"){i.setMinutes(i.getMinutes()+e)}else if(t==="second"){i.setSeconds(i.getSeconds()+e)}const a=this.formatValue(i);this._updateValueAndFireEvents(a,true,["change","value-changed"])}_handleWheel(e){e.preventDefault()}_hideMobileKeyboard(){this._getInput().readonly=true;setTimeout(()=>{this._getInput().readonly=false},0)}async _onfocusin(e){if(this._isPhone){this._hideMobileKeyboard();if(this._isInputsPopoverOpen){const e=await this._getInputsPopover();e.applyFocus()}e.preventDefault()}}_oninput(e){if(this._isPhone){e.preventDefault()}}get submitButtonLabel(){return F.i18nBundle.getText(O.TIMEPICKER_SUBMIT_BUTTON)}get cancelButtonLabel(){return F.i18nBundle.getText(O.TIMEPICKER_CANCEL_BUTTON)}get openIconName(){return"time-entry-request"}};T([(0,s.default)({defaultValue:undefined})],E.prototype,"value",void 0);T([(0,s.default)({type:p.default,defaultValue:p.default.None})],E.prototype,"valueState",void 0);T([(0,s.default)({type:Boolean})],E.prototype,"disabled",void 0);T([(0,s.default)({type:Boolean})],E.prototype,"readonly",void 0);T([(0,s.default)({type:Boolean,noAttribute:true})],E.prototype,"_isPickerOpen",void 0);T([(0,s.default)({type:Boolean,noAttribute:true})],E.prototype,"_isInputsPopoverOpen",void 0);T([(0,n.default)()],E.prototype,"valueStateMessage",void 0);E=F=T([(0,a.default)({languageAware:true,renderer:r.default,template:_.default,styles:S.default,staticAreaTemplate:y.default,staticAreaStyles:[B.default,k.default,D.default],dependencies:[m.default,g.default,P.default,w.default,V.default,I.default,b.default]}),(0,o.default)("change",{detail:{value:{type:String},valid:{type:Boolean}}}),(0,o.default)("input",{detail:{value:{type:String},valid:{type:Boolean}}})],E);var C=E;e.default=C});
//# sourceMappingURL=TimePickerBase.js.map