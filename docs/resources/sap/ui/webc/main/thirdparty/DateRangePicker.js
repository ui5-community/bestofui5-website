sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/Render","sap/ui/webc/common/thirdparty/localization/dates/CalendarDate","sap/ui/webc/common/thirdparty/localization/dates/modifyDateBy","sap/ui/webc/common/thirdparty/localization/dates/getTodayUTCTimestamp","./generated/i18n/i18n-defaults","./generated/themes/DateRangePicker.css","./DatePicker","./types/CalendarPickersMode"],function(e,t,i,a,s,r,l,n,u,o,m){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=d(t);i=d(i);s=d(s);r=d(r);l=d(l);u=d(u);o=d(o);m=d(m);function d(e){return e&&e.__esModule?e:{default:e}}var c=void 0&&(void 0).__decorate||function(e,t,i,a){var s=arguments.length,r=s<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,i):a,l;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(e,t,i,a);else for(var n=e.length-1;n>=0;n--)if(l=e[n])r=(s<3?l(r):s>3?l(t,i,r):l(t,i))||r;return s>3&&r&&Object.defineProperty(t,i,r),r};var h;let p=h=class e extends o.default{constructor(){super();this._prevDelimiter=null}get dateValue(){return null}get dateValueUTC(){return null}get _startDateTimestamp(){return this._extractFirstTimestamp(this.value)}get _endDateTimestamp(){return this._extractLastTimestamp(this.value)}get _tempTimestamp(){return this._tempValue&&this.getFormat().parse(this._tempValue,true).getTime()/1e3}get _calendarSelectionMode(){return"Range"}get _calendarTimestamp(){return this._tempTimestamp||this._startDateTimestamp||(0,l.default)(this._primaryCalendarType)}get _calendarSelectedDates(){if(this._tempValue){return[this._tempValue]}if(this.value&&this._checkValueValidity(this.value)){return this._splitValueByDelimiter(this.value)}return[]}get startDateValue(){return s.default.fromTimestamp(this._startDateTimestamp*1e3).toLocalJSDate()}get endDateValue(){return s.default.fromTimestamp(this._endDateTimestamp*1e3).toLocalJSDate()}get _placeholder(){return this.placeholder!==undefined?this.placeholder:`${this._displayFormat} ${this._effectiveDelimiter} ${this._displayFormat}`}get dateAriaDescription(){return h.i18nBundle.getText(n.DATERANGE_DESCRIPTION)}async _onInputSubmit(){const e=this._getInput();const t=e.getCaretPosition();await(0,a.renderFinished)();e.setCaretPosition(t)}onResponsivePopoverAfterClose(){this._tempValue="";super.onResponsivePopoverAfterClose()}isValid(e){const t=this._splitValueByDelimiter(e);return t.length<=2&&t.every(e=>super.isValid(e))}isInValidRange(e){return this._splitValueByDelimiter(e).every(e=>super.isInValidRange(e))}normalizeValue(e){const t=this._extractFirstTimestamp(e);const i=this._extractLastTimestamp(e);if(t&&i&&t>i){return this._buildValue(i,t)}return this._buildValue(t,i)}onSelectedDatesChange(e){e.preventDefault();const t=e.detail.values;if(t.length===0){return}if(t.length===1){this._tempValue=t[0];return}const i=this._buildValue(e.detail.dates[0],e.detail.dates[1]);this._updateValueAndFireEvents(i,true,["change","value-changed"]);this.closePicker()}async _modifyDateValue(e,t,i){if(!this._endDateTimestamp){return super._modifyDateValue(e,t,i)}const l=this._getInput();let n=l.getCaretPosition();let u;if(n<=this.value.indexOf(this._effectiveDelimiter)){const a=(0,r.default)(s.default.fromTimestamp(this._startDateTimestamp*1e3),e,t,i,this._minDate,this._maxDate);const l=a.valueOf()/1e3;if(l>this._endDateTimestamp){n+=Math.ceil(this.value.length/2)}u=this._buildValue(l,this._endDateTimestamp)}else{const a=(0,r.default)(s.default.fromTimestamp(this._endDateTimestamp*1e3),e,t,i,this._minDate,this._maxDate);const l=a.valueOf()/1e3;u=this._buildValue(this._startDateTimestamp,l);if(l<this._startDateTimestamp){n-=Math.ceil(this.value.length/2)}}this._updateValueAndFireEvents(u,true,["change","value-changed"]);await(0,a.renderFinished)();l.setCaretPosition(n)}get _effectiveDelimiter(){const e=this.constructor;return this.delimiter||e.getMetadata().getProperties().delimiter.defaultValue}_splitValueByDelimiter(e){const t=[];const i=e.split(this._prevDelimiter||this._effectiveDelimiter);if(this.getFormat().parse(e)){t[0]=i.join(this._effectiveDelimiter);t[1]=""}else{t[0]=i.slice(0,i.length/2).join(this._effectiveDelimiter);t[1]=i.slice(i.length/2).join(this._effectiveDelimiter)}return t}_extractFirstTimestamp(e){if(!e||!this._checkValueValidity(e)){return undefined}const t=this._splitValueByDelimiter(e);const i=this.getFormat().parse(t[0],true);return i.getTime()/1e3}_extractLastTimestamp(e){if(!e||!this._checkValueValidity(e)){return undefined}const t=this._splitValueByDelimiter(e);if(t[1]){const e=this.getFormat().parse(t[1],true);return e.getTime()/1e3}return undefined}_buildValue(e,t){this._prevDelimiter=this._effectiveDelimiter;if(e){const i=this._getStringFromTimestamp(e*1e3);if(!t){return i}const a=this._getStringFromTimestamp(t*1e3);return`${i} ${this._effectiveDelimiter} ${a}`}return""}get _calendarPickersMode(){return m.default.DAY_MONTH_YEAR}};c([(0,i.default)({defaultValue:"-"})],p.prototype,"delimiter",void 0);c([(0,i.default)()],p.prototype,"_tempValue",void 0);p=h=c([(0,t.default)({tag:"ui5-daterange-picker",styles:[o.default.styles,u.default]})],p);p.define();var f=p;e.default=f});
//# sourceMappingURL=DateRangePicker.js.map