sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/delegate/ItemNavigation","sap/ui/webc/common/thirdparty/base/types/CSSColor","sap/ui/webc/common/thirdparty/base/types/ItemNavigationBehavior","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","./generated/templates/ColorPaletteTemplate.lit","./generated/templates/ColorPaletteDialogTemplate.lit","./ColorPaletteItem","./Button","./generated/i18n/i18n-defaults","./generated/themes/ColorPalette.css","./generated/themes/ColorPaletteStaticArea.css"],function(e,t,o,s,i,l,r,a,n,c,h,u,C,d,f,p,m,g,w,y,_){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=v(t);o=v(o);s=v(s);i=v(i);l=v(l);r=v(r);n=v(n);c=v(c);h=v(h);f=v(f);p=v(p);m=v(m);g=v(g);y=v(y);_=v(_);function v(e){return e&&e.__esModule?e:{default:e}}var E=void 0&&(void 0).__decorate||function(e,t,o,s){var i=arguments.length,l=i<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,o):s,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")l=Reflect.decorate(e,t,o,s);else for(var a=e.length-1;a>=0;a--)if(r=e[a])l=(i<3?r(l):i>3?r(t,o,l):r(t,o))||l;return i>3&&l&&Object.defineProperty(t,o,l),l};var P;let b=P=class e extends t.default{static async onDefine(){const e=(0,d.getFeature)("ColorPaletteMoreColors");[P.i18nBundle]=await Promise.all([(0,a.getI18nBundle)("@ui5/webcomponents"),e?e.init():Promise.resolve()])}constructor(){super();this._itemNavigation=new n.default(this,{getItemsCallback:()=>this.displayedColors,rowSize:this.rowSize,behavior:h.default.Cyclic});this._itemNavigationRecentColors=new n.default(this,{getItemsCallback:()=>this.recentColorsElements,rowSize:this.rowSize,behavior:h.default.Static});this._recentColors=[]}onBeforeRendering(){this.displayedColors.forEach((e,t)=>{e.index=t+1});if(this.showMoreColors){const e=(0,d.getFeature)("ColorPaletteMoreColors");if(e){this.moreColorsFeature=new e}else{throw new Error(`You have to import "@ui5/webcomponents/dist/features/ColorPaletteMoreColors.js" module to use the more-colors functionality.`)}}}selectColor(e){if(!e.value){return}e.focus();if(this.displayedColors.includes(e)){this._itemNavigation.setCurrentItem(e)}this._setColor(e.value)}_setColor(e){this._selectedColor=e;if(this._recentColors[0]!==this._selectedColor){if(this._recentColors.includes(this._selectedColor)){this._recentColors.unshift(this._recentColors.splice(this._recentColors.indexOf(this._selectedColor),1)[0])}else{this._recentColors.unshift(this._selectedColor)}}this.fireEvent("item-click",{color:this._selectedColor})}_onclick(e){const t=e.target;if(t.hasAttribute("ui5-color-palette-item")){this.selectColor(t)}}_onkeyup(e){const t=e.target;if((0,C.isSpace)(e)&&t.hasAttribute("ui5-color-palette-item")){e.preventDefault();this.selectColor(t)}}_onkeydown(e){const t=e.target;if((0,C.isEnter)(e)&&t.hasAttribute("ui5-color-palette-item")){this.selectColor(t)}}_onDefaultColorKeyDown(e){if((0,C.isTabNext)(e)&&this.popupMode){e.preventDefault();this._onDefaultColorClick()}if((0,C.isDown)(e)){e.stopPropagation();this.focusColorElement(this.colorPaletteNavigationElements[1],this._itemNavigation)}else if((0,C.isUp)(e)){e.stopPropagation();const t=this.colorPaletteNavigationElements[this.colorPaletteNavigationElements.length-1];if(this.hasRecentColors){this.focusColorElement(t,this._itemNavigationRecentColors)}else if(this.showMoreColors){t.focus()}else{const e=this.displayedColors.length%this.rowSize*this.rowSize;this.focusColorElement(this.displayedColors[e],this._itemNavigation)}}}_onMoreColorsKeyDown(e){const t=e.target;const o=this.colorPaletteNavigationElements.indexOf(t);const s=this.displayedColors.length%this.rowSize*this.rowSize;if((0,C.isUp)(e)){e.stopPropagation();this.focusColorElement(this.displayedColors[s],this._itemNavigation)}else if((0,C.isDown)(e)){e.stopPropagation();if(this.hasRecentColors){this.focusColorElement(this.colorPaletteNavigationElements[o+1],this._itemNavigationRecentColors)}else if(this.showDefaultColor){this.colorPaletteNavigationElements[0].focus()}else{this.focusColorElement(this.displayedColors[0],this._itemNavigation)}}}_onColorContainerKeyDown(e){const t=e.target;const o=this.colorPaletteNavigationElements[this.colorPaletteNavigationElements.length-1];if((0,C.isTabNext)(e)&&this.popupMode){e.preventDefault();this.selectColor(t)}if((0,C.isUp)(e)&&t===this.displayedColors[0]&&this.colorPaletteNavigationElements.length>1){e.stopPropagation();if(this.showDefaultColor){this.colorPaletteNavigationElements[0].focus()}else if(!this.showDefaultColor&&this.hasRecentColors){this.focusColorElement(o,this._itemNavigationRecentColors)}else if(!this.showDefaultColor&&this.showMoreColors){o.focus()}}else if((0,C.isDown)(e)&&t===this.displayedColors[this.displayedColors.length-1]&&this.colorPaletteNavigationElements.length>1){e.stopPropagation();const t=this.showDefaultColor&&!this.showMoreColors&&this.hasRecentColors||!this.showDefaultColor&&!this.showMoreColors&&this.hasRecentColors;if(this.showDefaultColor&&this.showMoreColors){this.colorPaletteNavigationElements[2].focus()}else if(this.showDefaultColor&&!this.showMoreColors&&(!this.showRecentColors||!this.recentColors[0])){this.colorPaletteNavigationElements[0].focus()}else if(t){this.focusColorElement(o,this._itemNavigationRecentColors)}else if(!this.showDefaultColor&&this.showMoreColors){this.colorPaletteNavigationElements[1].focus()}}}_onRecentColorsContainerKeyDown(e){if((0,C.isUp)(e)){if(this.showMoreColors){const e=this.showDefaultColor?2:1;this.colorPaletteNavigationElements[e].focus()}else if(!this.showMoreColors&&this.colorPaletteNavigationElements.length>1){const t=this.displayedColors.length%this.rowSize*this.rowSize;e.stopPropagation();this.focusColorElement(this.displayedColors[t],this._itemNavigation)}}else if((0,C.isDown)(e)){if(this.showDefaultColor){this.colorPaletteNavigationElements[0].focus()}else{e.stopPropagation();this.focusColorElement(this.displayedColors[0],this._itemNavigation)}}}focusColorElement(e,t){t.setCurrentItem(e);t._focusCurrentItem()}async _chooseCustomColor(){const e=await this.getColorPicker();this._setColor(e.color);this._closeDialog()}async _closeDialog(){const e=await this._getDialog();e.close()}async _openMoreColorsDialog(){const e=await this._getDialog();e.show()}_onDefaultColorClick(){if(this.defaultColor){this._setColor(this.defaultColor)}}get selectedColor(){return this._selectedColor}get displayedColors(){const e=this.getSlottedNodes("colors");return e.filter(e=>e.value).slice(0,15)}get colorContainerLabel(){return P.i18nBundle.getText(w.COLORPALETTE_CONTAINER_LABEL)}get colorPaleteMoreColorsText(){return P.i18nBundle.getText(w.COLOR_PALETTE_MORE_COLORS_TEXT)}get _showMoreColors(){return this.showMoreColors&&this.moreColorsFeature}get rowSize(){return 5}get hasRecentColors(){return this.showRecentColors&&this.recentColors[0]}get recentColors(){if(this._recentColors.length>this.rowSize){this._recentColors=this._recentColors.slice(0,this.rowSize)}while(this._recentColors.length<this.rowSize){this._recentColors.push("")}return this._recentColors}get recentColorsElements(){const e=this.getDomRef();if(e){return Array.from(e.querySelectorAll(".ui5-cp-recent-colors-wrapper [ui5-color-palette-item]")).filter(e=>e.value!=="")}return[]}get colorPaletteNavigationElements(){const e=[];const t=this.shadowRoot.querySelector(".ui5-cp-root");if(this.showDefaultColor){e.push(t.querySelector(".ui5-cp-default-color-button"))}e.push(this.displayedColors[0]);if(this.showMoreColors){e.push(t.querySelector(".ui5-cp-more-colors"))}if(this.showRecentColors&&!!this.recentColorsElements.length){e.push(this.recentColorsElements[0])}return e}get classes(){return{colorPaletteRoot:{"ui5-cp-root":true,"ui5-cp-root-phone":(0,u.isPhone)()}}}async _getDialog(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-dialog]")}async getColorPicker(){const e=await this._getDialog();return e.content[0].querySelector("[ui5-color-picker]")}};E([(0,s.default)({type:Boolean})],b.prototype,"showRecentColors",void 0);E([(0,s.default)({type:Boolean})],b.prototype,"showMoreColors",void 0);E([(0,s.default)({type:Boolean})],b.prototype,"showDefaultColor",void 0);E([(0,s.default)({validator:c.default})],b.prototype,"defaultColor",void 0);E([(0,s.default)({validator:c.default})],b.prototype,"_selectedColor",void 0);E([(0,s.default)({type:Boolean})],b.prototype,"popupMode",void 0);E([(0,i.default)({default:true,type:HTMLElement,invalidateOnChildChange:true,individualSlots:true})],b.prototype,"colors",void 0);b=P=E([(0,o.default)({tag:"ui5-color-palette",renderer:r.default,template:f.default,staticAreaTemplate:p.default,styles:y.default,staticAreaStyles:_.default,get dependencies(){const e=(0,d.getFeature)("ColorPaletteMoreColors");return[m.default,g.default].concat(e?e.dependencies:[])}}),(0,l.default)("item-click",{detail:{color:{type:String}}})],b);b.define();var D=b;e.default=D});
//# sourceMappingURL=ColorPalette.js.map