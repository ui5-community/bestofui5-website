sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/locale/getLocale","sap/ui/webc/common/thirdparty/base/config/FormatSettings","sap/ui/webc/common/thirdparty/localization/getCachedLocaleDataInstance","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/localization/dates/CalendarDate","sap/ui/webc/common/thirdparty/localization/dates/calculateWeekNumber","sap/ui/webc/common/thirdparty/base/types/CalendarType","./types/CalendarSelectionMode","./CalendarPart","./generated/i18n/i18n-defaults","./generated/templates/DayPickerTemplate.lit","./generated/themes/DayPicker.css"],function(e,t,s,a,i,n,o,d,l,r,c,h,m,f,p,u,y){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=_(t);s=_(s);a=_(a);i=_(i);o=_(o);l=_(l);r=_(r);c=_(c);h=_(h);m=_(m);f=_(f);u=_(u);y=_(y);function _(e){return e&&e.__esModule?e:{default:e}}var g=void 0&&(void 0).__decorate||function(e,t,s,a){var i=arguments.length,n=i<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,s):a,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,s,a);else for(var d=e.length-1;d>=0;d--)if(o=e[d])n=(i<3?o(n):i>3?o(t,s,n):o(t,s))||n;return i>3&&n&&Object.defineProperty(t,s,n),n};var D;const T=(e,t,s)=>e>Math.min(t,s)&&e<Math.max(t,s);const S=7;let b=D=class e extends f.default{onBeforeRendering(){const e=(0,o.default)((0,i.default)());this._buildWeeks(e);this._buildDayNames(e)}_buildWeeks(e){if(this._hidden){return}this._weeks=[];const t=this._getFirstDayOfWeek();const s=e.getMonths("wide",this._primaryCalendarType);const a=this.hasSecondaryCalendarType?e.getMonths("wide",this.secondaryCalendarType):[];const o=D.i18nBundle.getText(p.DAY_PICKER_NON_WORKING_DAY);const d=D.i18nBundle.getText(p.DAY_PICKER_TODAY);const l=this._getFirstDay();const h=r.default.fromLocalJSDate(new Date,this._primaryCalendarType);const m=this._calendarDate;const f=this._minDate;const u=this._maxDate;const y=this.hasSecondaryCalendarType?this._getSecondaryDay(l):undefined;let _=[];for(let r=0;r<S*6;r++){const r=l.valueOf()/1e3;let p=l.getDay()-t;if(p<0){p+=S}const g=l.getMonth()===m.getMonth()&&l.getDate()===m.getDate();const D=this._isDaySelected(r);const T=this._isDayInsideSelectionRange(r);const b=l.getMonth()!==m.getMonth();const v=this._isWeekend(l);const w=l.valueOf()<f.valueOf()||l.valueOf()>u.valueOf();const M=l.isSame(h);const C=l.getDay()===t;const k=v?`${o} `:"";const O=M?`${d} `:"";const E=y?y.getDate():"";const N=y?y.getYear():"";const P=a.length>0?a[y.getMonth()]:"";const W=this.hasSecondaryCalendarType?`${O}${k}${s[l.getMonth()]} ${l.getDate()}, ${l.getYear()}; ${P} ${E}, ${N}`:`${O}${k}${s[l.getMonth()]} ${l.getDate()}, ${l.getYear()}`;const B={timestamp:r.toString(),focusRef:g,_tabIndex:g?"0":"-1",selected:D,day:l.getDate(),secondDay:this.hasSecondaryCalendarType?y.getDate():undefined,_isSecondaryCalendarType:this.hasSecondaryCalendarType,classes:`ui5-dp-item ui5-dp-wday${p}`,ariaLabel:W,ariaSelected:D?"true":"false",ariaDisabled:b?"true":undefined,disabled:w};if(C){B.classes+=" ui5-dp-firstday"}if(D){B.classes+=" ui5-dp-item--selected"}if(T){B.classes+=" ui5-dp-item--selected-between"}if(M){B.classes+=" ui5-dp-item--now"}if(b){B.classes+=" ui5-dp-item--othermonth"}if(v){B.classes+=" ui5-dp-item--weeekend"}if(w){B.classes+=" ui5-dp-item--disabled"}if(this.hasSecondaryCalendarType){B.classes+=" ui5-dp-item--withsecondtype"}_.push(B);if(p===S-1){_.unshift({weekNum:(0,c.default)((0,n.getFirstDayOfWeek)(),l.toUTCJSDate(),l.getYear(),(0,i.default)(),e),isHidden:this.shouldHideWeekNumbers})}if(_.length===S+1){this._weeks.push(_);_=[]}l.setDate(l.getDate()+1);if(this.hasSecondaryCalendarType&&y){y.setDate(y.getDate()+1)}}}_buildDayNames(e){if(this._hidden){return}let t;const s=e.getDays("wide",this._primaryCalendarType);const a=e.getDays("abbreviated",this._primaryCalendarType);let i;this._dayNames=[];this._dayNames.push({classes:"ui5-dp-dayname",name:D.i18nBundle.getText(p.DAY_PICKER_WEEK_NUMBER_TEXT)});for(let e=0;e<S;e++){t=e+this._getFirstDayOfWeek();if(t>S-1){t-=S}i={name:s[t],ultraShortName:a[t],classes:"ui5-dp-dayname"};this._dayNames.push(i)}this._dayNames[1].classes+=" ui5-dp-firstday";if(this.shouldHideWeekNumbers){this._dayNames.shift()}}onAfterRendering(){if(this._autoFocus&&!this._hidden){this.focus()}const e=this.shadowRoot.querySelector("[data-sap-focus-ref]");if(e&&document.activeElement!==e){e.focus()}}_onfocusin(){this._autoFocus=true}_onfocusout(){this._autoFocus=false}_isDaySelected(e){if(this.selectionMode===m.default.Single){return e===this.selectedDates[0]}return this.selectedDates.includes(e)}_isDayInsideSelectionRange(e){if(this.selectionMode!==m.default.Range||!this.selectedDates.length){return false}if(this.selectedDates.length===1&&this._secondTimestamp){return T(e,this.selectedDates[0],this._secondTimestamp)}return T(e,this.selectedDates[0],this.selectedDates[1])}_selectDate(e,t){const s=e.target;if(!this._isDayPressed(s)){return}const a=this._getTimestampFromDom(s);this._safelySetTimestamp(a);this._updateSecondTimestamp();if(this.selectionMode===m.default.Single){this.selectedDates=[a]}else if(this.selectionMode===m.default.Multiple){if(this.selectedDates.length>0&&t){this._multipleSelection(a)}else{this._toggleTimestampInSelection(a)}}else{this.selectedDates=this.selectedDates.length===1?[...this.selectedDates,a]:[a]}this.fireEvent("change",{timestamp:this.timestamp,dates:this.selectedDates})}_selectWeek(){this._weeks.forEach(e=>{const t=e;const s=t.findIndex(e=>{const t=r.default.fromTimestamp(parseInt(e.timestamp)*1e3);return t.getMonth()===this._calendarDate.getMonth()&&t.getDate()===this._calendarDate.getDate()})!==-1;if(s){const e=t.some(e=>e.timestamp&&!this.selectedDates.includes(parseInt(e.timestamp)));if(e){t.filter(e=>e.timestamp).forEach(e=>{this._addTimestampToSelection(parseInt(e.timestamp))})}else{t.filter(e=>e.timestamp).forEach(e=>{this._removeTimestampFromSelection(parseInt(e.timestamp))})}}});this.fireEvent("change",{timestamp:this.timestamp,dates:this.selectedDates})}_toggleTimestampInSelection(e){if(this.selectedDates.includes(e)){this._removeTimestampFromSelection(e)}else{this._addTimestampToSelection(e)}}_addTimestampToSelection(e){if(!this.selectedDates.includes(e)){this.selectedDates=[...this.selectedDates,e]}}_removeTimestampFromSelection(e){this.selectedDates=this.selectedDates.filter(t=>t!==e)}_multipleSelection(e){const t=Math.min(...this.selectedDates);const s=Math.max(...this.selectedDates);let a;let i;let n=false;if(e<t){a=e;i=t}else if(e>=t&&e<=s){const o=Math.abs(e-t);const d=Math.abs(e-s);if(o<d){a=e;i=s}else{a=t;i=e}n=true}else{a=s;i=e}const o=r.default.fromTimestamp(a*1e3);const d=r.default.fromTimestamp(i*1e3);while(o.valueOf()<=d.valueOf()){this[n?"_toggleTimestampInSelection":"_addTimestampToSelection"](o.valueOf()/1e3);o.setDate(o.getDate()+1)}}_onmouseover(e){const t=e.target;const s=t.closest(".ui5-dp-item");if(s&&this.selectionMode===m.default.Range&&this.selectedDates.length===1){this._secondTimestamp=this._getTimestampFromDom(s)}}_onkeydown(e){let t=true;if((0,d.isEnter)(e)||(0,d.isEnterShift)(e)){this._selectDate(e,(0,d.isEnterShift)(e))}else if((0,d.isSpace)(e)||(0,d.isSpaceShift)(e)){e.preventDefault()}else if((0,d.isLeft)(e)){this._modifyTimestampBy(-1,"day",false)}else if((0,d.isRight)(e)){this._modifyTimestampBy(1,"day",false)}else if((0,d.isUp)(e)){this._modifyTimestampBy(-7,"day",false)}else if((0,d.isDown)(e)){this._modifyTimestampBy(7,"day",false)}else if((0,d.isPageUp)(e)){this._modifyTimestampBy(-1,"month")}else if((0,d.isPageDown)(e)){this._modifyTimestampBy(1,"month")}else if((0,d.isPageUpShift)(e)||(0,d.isPageUpAlt)(e)){this._modifyTimestampBy(-1,"year")}else if((0,d.isPageDownShift)(e)||(0,d.isPageDownAlt)(e)){this._modifyTimestampBy(1,"year")}else if((0,d.isPageUpShiftCtrl)(e)){this._modifyTimestampBy(-10,"year")}else if((0,d.isPageDownShiftCtrl)(e)){this._modifyTimestampBy(10,"year")}else if((0,d.isHome)(e)||(0,d.isEnd)(e)){this._onHomeOrEnd((0,d.isHome)(e))}else if((0,d.isHomeCtrl)(e)){const e=new r.default(this._calendarDate,this._primaryCalendarType);e.setDate(1);this._setTimestamp(e.valueOf()/1e3)}else if((0,d.isEndCtrl)(e)){const e=new r.default(this._calendarDate,this._primaryCalendarType);e.setMonth(e.getMonth()+1);e.setDate(0);this._setTimestamp(e.valueOf()/1e3)}else{t=false}if(t){e.preventDefault()}}_onkeyup(e){if((0,d.isSpace)(e)||(0,d.isSpaceShift)(e)&&this.selectionMode!==m.default.Multiple){this._selectDate(e,false)}else if((0,d.isSpaceShift)(e)){this._selectWeek()}}_onclick(e){this._selectDate(e,e.shiftKey)}_onHomeOrEnd(e){this._weeks.forEach(t=>{const s=t;const a=s.findIndex(e=>{const t=r.default.fromTimestamp(parseInt(e.timestamp)*1e3);return t.getMonth()===this._calendarDate.getMonth()&&t.getDate()===this._calendarDate.getDate()})!==-1;if(a){const t=e?1:7;this._setTimestamp(parseInt(s[t].timestamp))}})}_hasPreviousPage(){return!(this._calendarDate.getMonth()===this._minDate.getMonth()&&this._calendarDate.getYear()===this._minDate.getYear())}_hasNextPage(){return!(this._calendarDate.getMonth()===this._maxDate.getMonth()&&this._calendarDate.getYear()===this._maxDate.getYear())}_showPreviousPage(){this._modifyTimestampBy(-1,"month",false)}_showNextPage(){this._modifyTimestampBy(1,"month",false)}_modifyTimestampBy(e,t,s){this._safelyModifyTimestampBy(e,t,s);this._updateSecondTimestamp();this.fireEvent("navigate",{timestamp:this.timestamp})}_setTimestamp(e){this._safelySetTimestamp(e);this._updateSecondTimestamp();this.fireEvent("navigate",{timestamp:this.timestamp})}_updateSecondTimestamp(){if(this.selectionMode===m.default.Range&&(this.selectedDates.length===1||this.selectedDates.length===2)){this._secondTimestamp=this.timestamp}}get shouldHideWeekNumbers(){if(this._primaryCalendarType!==h.default.Gregorian){return true}return this.hideWeekNumbers}get hasSecondaryCalendarType(){return!!this.secondaryCalendarType}_isWeekend(e){const t=(0,o.default)((0,i.default)());const s=e.getDay(),a=t.getWeekendStart(),n=t.getWeekendEnd();return s>=a&&s<=n||n<a&&(s>=a||s<=n)}_isDayPressed(e){const t=e.parentNode;return e.className.indexOf("ui5-dp-item")>-1||t&&t.classList&&t.classList.contains("ui5-dp-item")}_getSecondaryDay(e){return new r.default(e,this.secondaryCalendarType)}_getFirstDay(){let e;const t=this._getFirstDayOfWeek();const s=new r.default(this._calendarDate,this._primaryCalendarType);s.setDate(1);e=s.getDay()-t;if(e<0){e=7+e}if(e>0){s.setDate(1-e)}return s}_getFirstDayOfWeek(){const e=(0,o.default)((0,i.default)());const t=(0,n.getFirstDayOfWeek)();return Number.isInteger(t)?t:e.getFirstDayOfWeek()}get styles(){return{wrapper:{display:this._hidden?"none":"flex","justify-content":"center"},main:{width:"100%"}}}get ariaRoledescription(){return this.hasSecondaryCalendarType?`${this._primaryCalendarType} calendar with secondary ${this.secondaryCalendarType} calendar`:`${this._primaryCalendarType} calendar`}};g([(0,s.default)({validator:l.default,multiple:true,compareValues:true})],b.prototype,"selectedDates",void 0);g([(0,s.default)({type:m.default,defaultValue:m.default.Single})],b.prototype,"selectionMode",void 0);g([(0,s.default)({type:Boolean})],b.prototype,"hideWeekNumbers",void 0);g([(0,s.default)({type:Object,multiple:true})],b.prototype,"_weeks",void 0);g([(0,s.default)({type:Object,multiple:true})],b.prototype,"_dayNames",void 0);g([(0,s.default)({type:Boolean,noAttribute:true})],b.prototype,"_hidden",void 0);g([(0,s.default)()],b.prototype,"_secondTimestamp",void 0);b=D=g([(0,t.default)({tag:"ui5-daypicker",styles:y.default,template:u.default}),(0,a.default)("change"),(0,a.default)("navigate")],b);b.define();var v=b;e.default=v});
//# sourceMappingURL=DayPicker.js.map