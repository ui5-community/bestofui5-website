sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/types/ValueState","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","sap/ui/webc/common/thirdparty/base/types/Float","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","./generated/templates/StepInputTemplate.lit","./generated/i18n/i18n-defaults","sap/ui/webc/common/thirdparty/icons/less","sap/ui/webc/common/thirdparty/icons/add","./Icon","./Input","./types/InputType","./generated/themes/StepInput.css"],function(e,t,i,s,a,u,o,n,r,l,d,p,h,f,c,_,v,m,y,b,I,g){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=w(t);i=w(i);s=w(s);a=w(a);u=w(u);r=w(r);p=w(p);h=w(h);f=w(f);c=w(c);y=w(y);b=w(b);I=w(I);g=w(g);function w(e){return e&&e.__esModule?e:{default:e}}var V=void 0&&(void 0).__decorate||function(e,t,i,s){var a=arguments.length,u=a<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")u=Reflect.decorate(e,t,i,s);else for(var n=e.length-1;n>=0;n--)if(o=e[n])u=(a<3?o(u):a>3?o(t,i,u):o(t,i))||u;return a>3&&u&&Object.defineProperty(t,i,u),u};var S;const T=500;const D=.8;const B=50;const x=120;let C=S=class e extends t.default{static async onDefine(){S.i18nBundle=await(0,n.getI18nBundle)("@ui5/webcomponents")}get type(){return I.default.Number}get decIconTitle(){return S.i18nBundle.getText(_.STEPINPUT_DEC_ICON_TITLE)}get decIconName(){return"less"}get incIconTitle(){return S.i18nBundle.getText(_.STEPINPUT_INC_ICON_TITLE)}get incIconName(){return"add"}get _decIconClickable(){return!this._decIconDisabled&&!this.readonly&&!this.disabled}get _incIconClickable(){return!this._incIconDisabled&&!this.readonly&&!this.disabled}get _isFocused(){return this.focused}get _valuePrecisioned(){return this.value.toFixed(this.valuePrecision)}get accInfo(){return{ariaRequired:this.required,ariaLabel:(0,l.getEffectiveAriaLabelText)(this)}}get inputAttributes(){return{min:this.min===undefined?undefined:this.min,max:this.max===undefined?undefined:this.max,step:this.step}}onBeforeRendering(){this._setButtonState();if(this._previousValue===undefined){this._previousValue=this.value}const e=(0,d.getFeature)("FormSupport");if(e){e.syncNativeHiddenInput(this)}else if(this.name){console.warn(`In order for the "name" property to have effect, you should also: import "@ui5/webcomponents/dist/features/InputElementsFormSupport.js";`)}}get input(){return this.shadowRoot.querySelector("[ui5-input]")}get inputOuter(){return this.shadowRoot.querySelector(".ui5-step-input-input")}_onButtonFocusOut(){setTimeout(()=>{if(!this._inputFocused){this.inputOuter.removeAttribute("focused")}},0)}_onInputFocusIn(){this._inputFocused=true;if(this.value!==this._previousValue){this._previousValue=this.value}}_onInputFocusOut(){this._inputFocused=false;this._onInputChange()}_setButtonState(){this._decIconDisabled=this.min!==undefined&&this.value<=this.min;this._incIconDisabled=this.max!==undefined&&this.value>=this.max}_validate(){if(this._initialValueState===undefined){this._initialValueState=this.valueState}this.valueState=this.min!==undefined&&this.value<this.min||this.max!==undefined&&this.value>this.max?r.default.Error:this._initialValueState}_preciseValue(e){const t=10**this.valuePrecision;return Math.round(e*t)/t}_fireChangeEvent(){if(this._previousValue!==this.value){this._previousValue=this.value;this.fireEvent("change",{value:this.value})}}_modifyValue(e,t=false){let i;this.value=this._preciseValue(parseFloat(this.input.value));i=this.value+e;if(this.min!==undefined&&i<this.min){i=this.min}if(this.max!==undefined&&i>this.max){i=this.max}i=this._preciseValue(i);if(i!==this.value){this.value=i;this._validate();this._setButtonState();this.focused=true;this.inputOuter.setAttribute("focused","");if(t){this._fireChangeEvent()}else{this.input.focus()}}}_incValue(e){if(this._incIconClickable&&e.isTrusted&&!this.disabled&&!this.readonly){this._modifyValue(this.step,true);this._previousValue=this.value}}_decValue(e){if(this._decIconClickable&&e.isTrusted&&!this.disabled&&!this.readonly){this._modifyValue(-this.step,true);this._previousValue=this.value}}_onInputChange(){if(this.input.value===""){this.input.value=this.min||0}const e=this._preciseValue(parseFloat(this.input.value));if(this.value!==this._previousValue||this.value!==e){this.value=e;this._validate();this._setButtonState();this._fireChangeEvent()}}_onfocusin(){this.focused=true}_onfocusout(){this.focused=false}_onkeydown(e){let t=true;if(this.disabled||this.readonly){return}if((0,o.isEnter)(e)){this._onInputChange();return}if((0,o.isUp)(e)){this._modifyValue(this.step)}else if((0,o.isDown)(e)){this._modifyValue(-this.step)}else if((0,o.isEscape)(e)){this.value=this._previousValue;this.input.value=this.value.toFixed(this.valuePrecision)}else if(this.max!==undefined&&((0,o.isPageUpShift)(e)||(0,o.isUpShiftCtrl)(e))){this._modifyValue(this.max-this.value)}else if(this.min!==undefined&&((0,o.isPageDownShift)(e)||(0,o.isDownShiftCtrl)(e))){this._modifyValue(this.min-this.value)}else if(!(0,o.isUpCtrl)(e)&&!(0,o.isDownCtrl)(e)&&!(0,o.isUpShift)(e)&&!(0,o.isDownShift)(e)){t=false}if(t){e.preventDefault()}}_decSpin(){if(!this._decIconDisabled){this._spinValue(false,true)}}_incSpin(){if(!this._incIconDisabled){this._spinValue(true,true)}}_calcWaitTimeout(){this._speed*=D;this._waitTimeout=this._waitTimeout-this._speed<B?B:this._waitTimeout-this._speed;return this._waitTimeout}_spinValue(e,t=false){if(t){this._waitTimeout=T;this._speed=x;this._btnDown=true}this._spinTimeoutId=setTimeout(()=>{if(this._btnDown){this._spinStarted=true;this._modifyValue(e?this.step:-this.step);this._setButtonState();if(!this._incIconDisabled&&e||!this._decIconDisabled&&!e){this._spinValue(e)}else{this._resetSpin();this._fireChangeEvent()}}},this._calcWaitTimeout())}_resetSpin(){clearTimeout(this._spinTimeoutId);this._btnDown=false;this._spinStarted=false}_resetSpinOut(){if(this._btnDown){this._resetSpin();this._fireChangeEvent()}}};V([(0,s.default)({validator:p.default,defaultValue:0})],C.prototype,"value",void 0);V([(0,s.default)({validator:p.default})],C.prototype,"min",void 0);V([(0,s.default)({validator:p.default})],C.prototype,"max",void 0);V([(0,s.default)({validator:p.default,defaultValue:1})],C.prototype,"step",void 0);V([(0,s.default)({type:r.default,defaultValue:r.default.None})],C.prototype,"valueState",void 0);V([(0,s.default)({type:Boolean})],C.prototype,"required",void 0);V([(0,s.default)({type:Boolean})],C.prototype,"disabled",void 0);V([(0,s.default)({type:Boolean})],C.prototype,"readonly",void 0);V([(0,s.default)({defaultValue:undefined})],C.prototype,"placeholder",void 0);V([(0,s.default)()],C.prototype,"name",void 0);V([(0,s.default)({validator:h.default,defaultValue:0})],C.prototype,"valuePrecision",void 0);V([(0,s.default)()],C.prototype,"accessibleName",void 0);V([(0,s.default)({defaultValue:""})],C.prototype,"accessibleNameRef",void 0);V([(0,s.default)({type:Boolean,noAttribute:true})],C.prototype,"_decIconDisabled",void 0);V([(0,s.default)({type:Boolean,noAttribute:true})],C.prototype,"_incIconDisabled",void 0);V([(0,s.default)({type:Boolean})],C.prototype,"focused",void 0);V([(0,s.default)({type:Boolean,noAttribute:true})],C.prototype,"_inputFocused",void 0);V([(0,s.default)({validator:p.default,noAttribute:true})],C.prototype,"_previousValue",void 0);V([(0,s.default)({validator:p.default,noAttribute:true})],C.prototype,"_waitTimeout",void 0);V([(0,s.default)({validator:p.default,noAttribute:true})],C.prototype,"_speed",void 0);V([(0,s.default)({type:Boolean,noAttribute:true})],C.prototype,"_btnDown",void 0);V([(0,s.default)({validator:h.default,noAttribute:true})],C.prototype,"_spinTimeoutId",void 0);V([(0,s.default)({type:Boolean,noAttribute:true})],C.prototype,"_spinStarted",void 0);V([(0,a.default)()],C.prototype,"valueStateMessage",void 0);V([(0,a.default)()],C.prototype,"formSupport",void 0);C=S=V([(0,i.default)({tag:"ui5-step-input",renderer:f.default,styles:g.default,template:c.default,dependencies:[y.default,b.default]}),(0,u.default)("change")],C);C.define();var E=C;e.default=E});
//# sourceMappingURL=StepInput.js.map