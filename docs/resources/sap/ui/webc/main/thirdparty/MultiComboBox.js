sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/types/ValueState","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/icons/slim-arrow-down","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/icons/decline","sap/ui/webc/common/thirdparty/icons/multiselect-all","sap/ui/webc/common/thirdparty/icons/not-editable","sap/ui/webc/common/thirdparty/icons/error","sap/ui/webc/common/thirdparty/icons/alert","sap/ui/webc/common/thirdparty/icons/sys-enter-2","sap/ui/webc/common/thirdparty/icons/information","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/CustomElementsScope","./MultiComboBoxItem","./MultiComboBoxGroupItem","./GroupHeaderListItem","./Tokenizer","./Token","./Icon","./Popover","./ResponsivePopover","./List","./StandardListItem","./ToggleButton","./Filters","./Button","./generated/i18n/i18n-defaults","./generated/templates/MultiComboBoxTemplate.lit","./generated/templates/MultiComboBoxPopoverTemplate.lit","./generated/themes/MultiComboBox.css","./generated/themes/ResponsivePopoverCommon.css","./generated/themes/ValueStateMessage.css","./generated/themes/Suggestions.css","./generated/themes/MultiComboBoxPopover.css","./types/ComboBoxFilter"],function(e,t,i,s,o,n,r,a,l,u,h,d,c,f,p,m,_,g,v,S,y,I,T,b,w,x,k,P,A,C,E,D,B,R,z,O,V,M,L,F,N,U,W,H,G,K){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=q(t);i=q(i);s=q(s);o=q(o);n=q(n);r=q(r);a=q(a);l=q(l);h=q(h);w=q(w);x=q(x);k=q(k);P=$(P);A=q(A);C=q(C);E=q(E);D=q(D);B=q(B);R=q(R);z=q(z);O=$(O);V=q(V);L=q(L);F=q(F);N=q(N);U=q(U);W=q(W);H=q(H);G=q(G);K=q(K);function j(e){if(typeof WeakMap!=="function")return null;var t=new WeakMap;var i=new WeakMap;return(j=function(e){return e?i:t})(e)}function $(e,t){if(!t&&e&&e.__esModule){return e}if(e===null||typeof e!=="object"&&typeof e!=="function"){return{default:e}}var i=j(t);if(i&&i.has(e)){return i.get(e)}var s={};var o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e){if(n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)){var r=o?Object.getOwnPropertyDescriptor(e,n):null;if(r&&(r.get||r.set)){Object.defineProperty(s,n,r)}else{s[n]=e[n]}}}s.default=e;if(i){i.set(e,s)}return s}function q(e){return e&&e.__esModule?e:{default:e}}var Y=void 0&&(void 0).__decorate||function(e,t,i,s){var o=arguments.length,n=o<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)if(r=e[a])n=(o<3?r(n):o>3?r(t,i,n):r(t,i))||n;return o>3&&n&&Object.defineProperty(t,i,n),n};var X;let J=X=class e extends t.default{constructor(){super();this._filteredItems=[];this._previouslySelectedItems=[];this.selectedValues=[];this._itemsBeforeOpen=[];this._inputLastValue="";this._valueBeforeOpen="";this._deleting=false;this._validationTimeout=null;this._handleResizeBound=this._handleResize.bind(this);this.valueBeforeAutoComplete="";this._lastValue="";this.currentItemIdx=-1;this.FormSupport=undefined}onEnterDOM(){a.default.register(this,this._handleResizeBound)}onExitDOM(){a.default.deregister(this,this._handleResizeBound)}_handleResize(){this._inputWidth=this.offsetWidth}_inputChange(){this.fireEvent("change")}togglePopover(){this._tokenizer.closeMorePopover();this.allItemsPopover?.toggle(this)}togglePopoverByDropdownIcon(){this._shouldFilterItems=false;this.allItemsPopover?.toggle(this);this._tokenizer.closeMorePopover()}_showFilteredItems(){this.filterSelected=true;this._showMorePressed=true;this.togglePopover()}filterSelectedItems(e){this.filterSelected=e.target.pressed;const t=this._filteredItems.filter(e=>e.selected);this.selectedItems=this.items.filter((e,i,s)=>X._groupItemFilter(e,++i,s,t)||t.indexOf(e)!==-1)}get _showAllItemsButtonPressed(){return this.filterSelected}get _inputDom(){return this.shadowRoot.querySelector("#ui5-multi-combobox-input")}_inputLiveChange(e){const t=e.target;const i=t.value;const s=this._filterItems(i);const o=this.valueState;this._shouldFilterItems=true;if(this.filterSelected){this.filterSelected=false}if(this._validationTimeout){t.value=this._inputLastValue;return}if(!s.length&&i&&!this.allowCustomValues){t.value=this.valueBeforeAutoComplete||this._inputLastValue;this.valueState=l.default.Error;this._shouldAutocomplete=false;this._resetValueState(o);return}this._inputLastValue=t.value;this.value=t.value;this._filteredItems=s;if(!(0,c.isPhone)()){if(s.length===0){this.allItemsPopover?.close()}else{this.allItemsPopover?.showAt(this)}}this.fireEvent("input")}_tokenDelete(e){this._previouslySelectedItems=this._getSelectedItems();const t=e.detail.ref;const i=this.items.find(e=>e._id===t.getAttribute("data-ui5-id"));i.selected=false;this._deleting=true;this._preventTokenizerToggle=true;this.focus();const s=this.fireSelectionChange();if(s){this._revertSelection()}}get _getPlaceholder(){if(this._getSelectedItems().length){return""}return this.placeholder}_handleArrowLeft(){const e=this._inputDom;const t=e.selectionStart||0;const i=(e.selectionEnd||0)-t>0;if(t===0&&!i){this._tokenizer._focusLastToken()}}_tokenizerFocusOut(e){this._tokenizerFocused=false;const t=this._tokenizer.tokens.length;const i=this._selectedTokensCount;const s=t-1===0&&this._deleting;const o=i===t&&this._deleting;const n=e.relatedTarget;const r=this.staticAreaItem===n;const a=this._inputDom===n;const l=e.relatedTarget===this._tokenizer.staticAreaItem;if(!n?.hasAttribute("ui5-token")&&!r&&!a&&!l){this._tokenizer.tokens.forEach(e=>{e.selected=false});this._tokenizer.expanded=this._preventTokenizerToggle?this._tokenizer.expanded:false}if(o||s){setTimeout(()=>{if(!(0,c.isPhone)()){this._inputDom.focus()}this._deleting=false},0)}}_tokenizerFocusIn(){this._tokenizerFocused=true;this.focused=false}_onkeydown(e){const t=(0,u.isDownCtrl)(e);const i=e.metaKey||e.ctrlKey;if((0,u.isShow)(e)&&!this.disabled){this._handleShow(e);return}if((0,u.isDownShift)(e)||(0,u.isUpShift)(e)){e.preventDefault();return}if((0,u.isUp)(e)||(0,u.isDown)(e)||(0,u.isUpCtrl)(e)||t){this._handleArrowNavigation(e,t);return}if(t&&!this.allItemsPopover?.opened){setTimeout(()=>this._inputDom.setSelectionRange(0,this._inputDom.value.length),0)}if((0,u.isLeftCtrl)(e)||(0,u.isRightCtrl)(e)){this._handleArrowCtrl(e);return}if((0,u.isInsertShift)(e)){this._handleInsertPaste();return}if(i&&e.key.toLowerCase()==="i"&&this._tokenizer.tokens.length>0){e.preventDefault();this.togglePopover()}if((0,u.isSpaceShift)(e)){e.preventDefault()}if(e.key==="ArrowLeft"||e.key==="Show"||e.key==="PageUp"||e.key==="PageDown"||e.key==="Backspace"||e.key==="Escape"||e.key==="Home"||e.key==="End"||e.key==="Tab"||e.key==="ArrowDown"||e.key==="Enter"){this[`_handle${e.key}`](e)}this._shouldAutocomplete=!this.noTypeahead&&!((0,u.isBackSpace)(e)||(0,u.isDelete)(e)||(0,u.isEscape)(e)||(0,u.isEnter)(e))}_handlePaste(e){e.preventDefault();if(this.readonly||!e.clipboardData){return}const t=e.clipboardData.getData("text/plain");if(!t){return}this._createTokenFromText(t)}async _handleInsertPaste(){if(this.readonly||(0,c.isFirefox)()){return}const e=await navigator.clipboard.readText();if(!e){return}this._createTokenFromText(e)}_createTokenFromText(e){const t=e.split(/\r\n|\r|\n|\t/g).filter(e=>!!e);const i=this.items.filter(e=>t.indexOf(e.text)>-1&&!e.selected);if(t.length>1){this._previouslySelectedItems=this._getSelectedItems();i.forEach(e=>{e.selected=true;this.value="";const t=this.fireSelectionChange();if(t){this._revertSelection()}})}else{this.value=e;this.fireEvent("input")}}_handleShow(e){const t=this.items;const i=this._getSelectedItems()[0];const s=this._tokenizer.tokens.find(e=>e.focused);const o=this.value;const n=this.items.find(e=>e.text.localeCompare(o,undefined,{sensitivity:"base"})===0);e.preventDefault();if(this.readonly){return}this._isOpenedByKeyboard=true;this._shouldFilterItems=false;this._filteredItems=this.items;this.togglePopover();if(!s&&n){this._itemToFocus=n;return}if(i&&!s){this._itemToFocus=i}else if(s&&e.target===s){this._itemToFocus=t.find(e=>e.text===s.text)}else{this._itemToFocus=t[0]}}_handlePageUp(e){e.preventDefault()}_handlePageDown(e){e.preventDefault()}_handleBackspace(e){if(e.target.value===""){e.preventDefault();this._tokenizer._focusLastToken()}}_handleEscape(){const e=this._innerInput;const t=(e.selectionEnd||0)-(e.selectionStart||0)>0;if(t){this.value=this.valueBeforeAutoComplete}if(!this.allowCustomValues||!this.open&&this.allowCustomValues){this.value=this._lastValue}}_handleHome(e){const t=this._isFocusInside&&e.target.selectionStart===0&&this._tokenizer.tokens.length>0;if(t){e.preventDefault();this._tokenizer.tokens[0].focus()}}_handleEnd(e){const t=this._tokenizer.tokens;const i=t.length-1;const s=e.target===t[i]&&t[i]===this.shadowRoot.activeElement;if(s){e.preventDefault();this._inputDom.focus()}}_handleTab(){this.allItemsPopover?.close()}_handleSelectAll(){const e=this._filteredItems;const t=e.every(e=>e.selected);this._previouslySelectedItems=e.filter(e=>e.selected).map(e=>e);e.forEach(e=>{e.selected=!t});const i=this.fireSelectionChange();if(i){this._revertSelection()}}_onValueStateKeydown(e){const t=(0,u.isDown)(e);const i=(0,u.isUp)(e);if((0,u.isTabNext)(e)||(0,u.isTabPrevious)(e)){this._onItemTab();return}e.preventDefault();if(t||(0,u.isDownCtrl)(e)){this._handleArrowDown()}if(i||(0,u.isUpCtrl)(e)){this._shouldAutocomplete=true;this._inputDom.focus()}}async _onItemKeydown(e){const t=this.list?.items[0]===e.target;const i=(0,u.isUp)(e)||(0,u.isUpCtrl)(e);if(this.hasValueStateMessage&&!this.valueStateHeader){await this._setValueStateHeader()}if((0,u.isTabNext)(e)||(0,u.isTabPrevious)(e)){this._onItemTab();return}if((0,u.isHomeCtrl)(e)){this.list?._itemNavigation._handleHome();this.list?.items[this.list?._itemNavigation._currentIndex].focus()}if((0,u.isEndCtrl)(e)){this.list?._itemNavigation._handleEnd();this.list?.items[this.list?._itemNavigation._currentIndex].focus()}e.preventDefault();if((0,u.isDownShift)(e)||(0,u.isUpShift)(e)){this._handleItemRangeSelection(e);return}if((0,u.isUpCtrl)(e)&&!t){this.list?._itemNavigation._handleUp();this.list?.items[this.list?._itemNavigation._currentIndex].focus()}if((0,u.isDownCtrl)(e)){this.list?._itemNavigation._handleDown();this.list?.items[this.list?._itemNavigation._currentIndex].focus()}if((0,u.isShow)(e)){this.togglePopover()}if((0,u.isCtrlA)(e)){this._handleSelectAll();return}if((i&&t||(0,u.isHome)(e))&&this.valueStateHeader){this.valueStateHeader.focus()}if(!this.valueStateHeader&&t&&i){this._inputDom.focus();this._shouldAutocomplete=true}}_handleArrowCtrl(e){const t=this._inputDom;const i=(0,u.isLeftCtrl)(e);if(i&&t.selectionStart===0&&t.selectionEnd===0){e.preventDefault()}if(i&&(t.selectionEnd||0)-(t.selectionStart||0)>0){t.setSelectionRange(0,0)}}_onItemTab(){this._inputDom.focus();this.allItemsPopover?.close()}async _handleArrowNavigation(e,t){const i=t||(0,u.isDown)(e);const s=this.items.length;const o=this.allItemsPopover?.opened;e.preventDefault();if(this.hasValueStateMessage&&!this.valueStateHeader){await this._setValueStateHeader()}if(i&&o&&this.valueStateHeader){this.value=this.valueBeforeAutoComplete||this.value;this.valueStateHeader.focus();return}if(i&&s){this._handleArrowDown()}if(!i&&!o&&!this.readonly){this._navigateToPrevItem()}}_handleArrowDown(){const e=this.allItemsPopover?.opened;const t=this.list?.items[0];if(e){t&&this.list?._itemNavigation.setCurrentItem(t);this.value=this.valueBeforeAutoComplete||this.value;t?.focus()}else if(!this.readonly){this._navigateToNextItem()}}_handleItemRangeSelection(e){const t=this.items;const i=this.list?.items;const s=Number(i?.indexOf(e.target));const o=s+1;const n=s-1;this._previouslySelectedItems=this._getSelectedItems();if((0,u.isDownShift)(e)&&t[o]){t[o].selected=t[s].selected;t[o].focus()}if((0,u.isUpShift)(e)&&t[n]){t[n].selected=t[s].selected;t[n].focus()}const r=this.fireSelectionChange();if(r){this._revertSelection()}}_navigateToNextItem(){const e=this.items;const t=e.length;const i=this.currentItemIdx;if(i>-1&&e[i].text!==this.value){this.currentItemIdx=-1}if(i>=t-1){return}let s=this.items[++this.currentItemIdx];while(this.currentItemIdx<t-1&&s.selected||s.isGroupItem){s=this.items[++this.currentItemIdx]}if(s.selected===true||s.isGroupItem){this.currentItemIdx=i;return}this.value=s.text;this._innerInput.value=s.text;this._innerInput.setSelectionRange(0,s.text.length)}_navigateToPrevItem(){const e=this.items;let t=this.currentItemIdx;if(!this.value&&t!==-1||t!==-1&&this.value&&this.value!==e[t].text){t=-1}if(t===-1){this.currentItemIdx=e.length}if(t===0){this.currentItemIdx=0;return}let i=this.items[--this.currentItemIdx];while(i&&this.currentItemIdx>0&&(i.selected||i.isGroupItem)){i=this.items[--this.currentItemIdx]}if(!i){return}if(i.selected||i.isGroupItem){this.currentItemIdx=t;return}this.value=i.text;this._innerInput.value=i.text;this._innerInput.setSelectionRange(0,i.text.length)}_handleEnter(){const e=this.value.toLowerCase();const t=this.items.find(t=>t.text.toLowerCase()===e&&!t.isGroupItem);const i=this.valueState;const s=this._innerInput;if(this.FormSupport){this.FormSupport.triggerFormSubmit(this)}if(t){if(t.selected){if(this._validationTimeout){return}this.valueState=l.default.Error;this._performingSelectionTwice=true;this._resetValueState(i,()=>{this._performingSelectionTwice=false})}else{this._previouslySelectedItems=this._getSelectedItems();t.selected=true;this.value="";const e=this.fireSelectionChange();if(e){this._revertSelection()}}s.setSelectionRange(t.text.length,t.text.length);this.allItemsPopover?.close()}}_resetValueState(e,t){this._validationTimeout=setTimeout(()=>{this.valueState=e;this._validationTimeout=null;t&&t()},2e3)}_onTokenizerKeydown(e){const t=!!(e.metaKey||e.ctrlKey);if((0,u.isRight)(e)){const t=this._tokenizer.tokens.length-this._tokenizer.overflownTokens.length-1;if(e.target===this._tokenizer.tokens[t]){setTimeout(()=>{this._inputDom.focus()},0)}}if(t&&["c","x"].includes(e.key.toLowerCase())||(0,u.isDeleteShift)(e)||(0,u.isInsertCtrl)(e)){e.preventDefault();const t=e.key.toLowerCase()==="x"||(0,u.isDeleteShift)(e);const i=this._tokenizer.tokens.filter(e=>e.selected);if(t){const e=this._tokenizer._fillClipboard(P.ClipboardDataOperation.cut,i);i.forEach(e=>{this._tokenizer.deleteToken(e)});this.focus();return e}return this._tokenizer._fillClipboard(P.ClipboardDataOperation.copy,i)}if((0,u.isInsertShift)(e)){this._handleInsertPaste()}if((0,u.isHome)(e)){this._handleHome(e)}if((0,u.isEnd)(e)){this._handleEnd(e)}if((0,u.isShow)(e)&&!this.readonly&&!this.disabled){this._preventTokenizerToggle=true;this._handleShow(e)}if(t&&e.key.toLowerCase()==="i"&&this._tokenizer.tokens.length>0){e.preventDefault();this.togglePopover()}}_filterItems(e){const t=this.items.filter(e=>!e.isGroupItem);const i=(O[this.filter]||O.StartsWithPerTerm)(e,t,"text");return this.items.filter((e,t,s)=>X._groupItemFilter(e,++t,s,i)||i.indexOf(e)!==-1)}static _groupItemFilter(e,t,i,s){if(e.isGroupItem){let e;while(i[t]&&!i[t].isGroupItem&&!e){e=s.indexOf(i[t])!==-1;t++}return e}}_afterOpenPicker(){this._toggle();if(!(0,c.isPhone)()&&!this._isOpenedByKeyboard){this._innerInput.focus()}else if(this._isOpenedByKeyboard){this._itemToFocus?.focus()}else{this.allItemsPopover?.focus()}this._previouslySelectedItems=this._getSelectedItems();this._isOpenedByKeyboard=false}_toggle(){this.open=!this.open;this.fireEvent("open-change")}_getSelectedItems(){this.selectedValues=this.items.filter(e=>e.selected);return this.selectedValues}_listSelectionChange(e){let t;if(!(0,c.isPhone)()){this._previouslySelectedItems=this._getSelectedItems()}this.syncItems(e.target.items);if(!(0,c.isPhone)()){t=this.fireSelectionChange();if(t){e.preventDefault();this._revertSelection()}}const i={key:e.detail.key};if(!e.detail.selectionComponentPressed&&!(0,u.isSpace)(i)&&!(0,u.isSpaceCtrl)(i)){this.allItemsPopover?.close();this.value="";if((0,c.isPhone)()){t=this.fireSelectionChange();if(t){e.preventDefault();this._revertSelection()}}this.fireEvent("input")}this.value=this.valueBeforeAutoComplete||""}syncItems(e){e.forEach(e=>{this.items.forEach(t=>{if(t._id===e.getAttribute("data-ui5-token-id")){t.selected=e.selected}})})}fireSelectionChange(){const e=!this.fireEvent("selection-change",{items:this._getSelectedItems()},true);this.fireEvent("value-changed");return e}async _getRespPopover(){const e=await this.getStaticAreaItemDomRef();this.allItemsPopover=e.querySelector(`.ui5-multi-combobox-all-items-responsive-popover`)}async _getList(){const e=await this.getStaticAreaItemDomRef();this.list=e.querySelector(".ui5-multi-combobox-all-items-list");return this.list}_click(){if((0,c.isPhone)()&&!this.readonly&&!this._showMorePressed&&!this._deleting){this.allItemsPopover?.showAt(this)}this._showMorePressed=false}async handleBeforeTokenizerPopoverOpen(){const e=this._tokenizer.tokens;const t=e.length===1&&e[0].isTruncatable;const i=await this._getResponsivePopover();if(t){i?.close(false,false,true)}}_afterClosePicker(){if((0,c.isPhone)()){this.blur()}this._toggle();this._iconPressed=false;this._preventTokenizerToggle=false;this.filterSelected=false}_beforeOpen(){this._itemsBeforeOpen=this.items.map(e=>({ref:e,selected:e.selected}));this._valueBeforeOpen=this.value;if(this.filterSelected){const e=this._filteredItems.filter(e=>e.selected);this.selectedItems=this.items.filter((t,i,s)=>X._groupItemFilter(t,++i,s,e)||e.indexOf(t)!==-1)}}_handleTypeAhead(e,t){if(!e){return}const i=e.text;const s=this._innerInput;t=t||"";this.value=i;s.value=i;s.setSelectionRange(t.length,i.length);this._shouldAutocomplete=false}_getFirstMatchingItem(e){if(!this.items.length){return}const t=this._startsWithMatchingItems(e).filter(e=>!e.isGroupItem&&!e.selected);if(t.length){return t[0]}}_startsWithMatchingItems(e){return O.StartsWith(e,this.items,"text")}_revertSelection(){this._filteredItems.forEach(e=>{e.selected=this._previouslySelectedItems.includes(e)})}onBeforeRendering(){const e=this._innerInput;const t=e&&(e.selectionEnd||0)-(e.selectionStart||0);const i=e&&e.value;this.FormSupport=(0,I.getFeature)("FormSupport");this._inputLastValue=i;if(e&&!e.value){this.valueBeforeAutoComplete="";this._filteredItems=this.items}this.items.forEach(e=>{e._getRealDomRef=()=>this.allItemsPopover.querySelector(`*[data-ui5-stable=${e.stableDomRef}]`)});this.tokenizerAvailable=this._getSelectedItems().length>0;this.style.setProperty((0,b.getScopedVarName)("--_ui5-input-icons-count"),`${this.iconsCount}`);if(!e||!i){return}if(this._shouldAutocomplete&&!(0,c.isAndroid)()&&!t){const e=this._getFirstMatchingItem(i);this.valueBeforeAutoComplete=i;e&&this._handleTypeAhead(e,i)}if(this._shouldFilterItems){this._filteredItems=this._filterItems(this._shouldAutocomplete||!!t?this.valueBeforeAutoComplete:i)}else{this._filteredItems=this.items}}async onAfterRendering(){await this._getRespPopover();await this._getList();this.toggle(this.shouldDisplayOnlyValueStateMessage);this.storeResponsivePopoverWidth();this._deleting=false;this._tokenizer._handleResize()}get _isPhone(){return(0,c.isPhone)()}_onIconMousedown(){this._iconPressed=true}storeResponsivePopoverWidth(){if(this.open&&!this._listWidth){this._listWidth=this.list.offsetWidth}}toggle(e){if(e&&!this.open){this.openPopover()}else{this.closePopover()}}handleCancel(){this._itemsBeforeOpen.forEach(e=>{if(e.ref instanceof w.default){e.ref.selected=e.selected}});this.togglePopover();this.value=this._valueBeforeOpen}handleOK(){if((0,c.isPhone)()){const e=this.fireSelectionChange();if(e){this._revertSelection()}}if(!this.allowCustomValues){this.value=""}this.togglePopover()}async openPopover(){(await this._getPopover())?.showAt(this)}_forwardFocusToInner(){this._innerInput.focus()}get morePopoverOpener(){const e=this._tokenizer?.tokens;if(e?.length===1&&e[0].isTruncatable){return e[0]}return this}async closePopover(){(await this._getPopover())?.close()}async _getPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-popover]")}async _getResponsivePopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-responsive-popover]")}async _setValueStateHeader(){const e=await this._getResponsivePopover();this.valueStateHeader=e.querySelector("div.ui5-responsive-popover-header.ui5-valuestatemessage-root")}get _tokenizer(){return this.shadowRoot.querySelector("[ui5-tokenizer]")}inputFocusIn(e){if(!(0,c.isPhone)()||this.readonly){this.focused=true;this._tokenizer.expanded=true}else{this._innerInput.blur()}if(!(0,c.isPhone)()&&(e.relatedTarget?.tagName!=="UI5-STATIC-AREA-ITEM"||!e.relatedTarget)){this._innerInput.setSelectionRange(0,this.value.length)}this._tokenizer.tokens.forEach(e=>{e.selected=false});this._lastValue=this.value;this.valueBeforeAutoComplete=""}inputFocusOut(e){if(!this.shadowRoot.contains(e.relatedTarget)&&!this._deleting){this.focused=false;this._tokenizer.expanded=this.open;if(!(0,c.isPhone)()&&!this.allowCustomValues&&this.staticAreaItem!==e.relatedTarget){this.value=""}}}get editable(){return!this.readonly}get _isFocusInside(){return!(0,c.isPhone)()&&(this.focused||this._tokenizerFocused)}get selectedItemsListMode(){return this.readonly?"None":"MultiSelect"}get _listItemsType(){return this.readonly?"Inactive":"Active"}get hasValueState(){return this.valueState!==l.default.None}get hasValueStateMessage(){return this.hasValueState&&this.valueState!==l.default.Success}get ariaValueStateHiddenText(){if(!this.hasValueState){return}let e="";if(this.valueState!==l.default.None){e=this.valueStateTypeMappings[this.valueState]}if(this.shouldDisplayDefaultValueStateMessage){return`${e} ${this.valueStateDefaultText||""}`}return`${e}`.concat(" ",this.valueStateMessageText.map(e=>e.textContent).join(" "))}get valueStateDefaultText(){if(this.valueState===l.default.None){return""}if(this._performingSelectionTwice){return X.i18nBundle.getText(M.VALUE_STATE_ERROR_ALREADY_SELECTED)}return this.valueStateTextMappings[this.valueState]}get valueStateTextId(){return this.hasValueState?`ui5-multi-combobox-valueStateDesc`:undefined}get valueStateMessageText(){return this.getSlottedNodes("valueStateMessage").map(e=>e.cloneNode(true))}get ariaLabelText(){return(0,T.getEffectiveAriaLabelText)(this)}get _valueStateMessageIcon(){if(this.valueState===l.default.None){return""}return{[l.default.Error]:"error",[l.default.Warning]:"alert",[l.default.Success]:"sys-enter-2",[l.default.Information]:"information"}[this.valueState]}get _tokensCountText(){if(!this._tokenizer){return}return this._tokenizer._tokensCountText()}get _tokensCountTextId(){return"ui5-multi-combobox-hiddenText-nMore"}get _selectedTokensCount(){return this._tokenizer.tokens.filter(e=>e.selected).length}get ariaDescribedByText(){return this.valueStateTextId?`${this._tokensCountTextId} ${this.valueStateTextId}`:`${this._tokensCountTextId}`}get shouldDisplayDefaultValueStateMessage(){return!this.valueStateMessage.length&&this.hasValueStateMessage}get shouldDisplayOnlyValueStateMessage(){return this.focused&&!this.readonly&&this.hasValueStateMessage&&!this._iconPressed}get valueStateTypeMappings(){return{[l.default.Success]:X.i18nBundle.getText(M.VALUE_STATE_TYPE_SUCCESS),[l.default.Information]:X.i18nBundle.getText(M.VALUE_STATE_TYPE_INFORMATION),[l.default.Error]:X.i18nBundle.getText(M.VALUE_STATE_TYPE_ERROR),[l.default.Warning]:X.i18nBundle.getText(M.VALUE_STATE_TYPE_WARNING)}}get valueStateTextMappings(){return{[l.default.Success]:X.i18nBundle.getText(M.VALUE_STATE_SUCCESS),[l.default.Error]:X.i18nBundle.getText(M.VALUE_STATE_ERROR),[l.default.Warning]:X.i18nBundle.getText(M.VALUE_STATE_WARNING),[l.default.Information]:X.i18nBundle.getText(M.VALUE_STATE_INFORMATION)}}get _innerInput(){if((0,c.isPhone)()){if(this.allItemsPopover?.opened){return this.allItemsPopover.querySelector("input")}}return this._inputDom}get _headerTitleText(){return X.i18nBundle.getText(M.INPUT_SUGGESTIONS_TITLE)}get _iconAccessibleNameText(){return X.i18nBundle.getText(M.SELECT_OPTIONS)}get _dialogOkButton(){return X.i18nBundle.getText(M.MULTICOMBOBOX_DIALOG_OK_BUTTON)}get _tokenizerExpanded(){if((0,c.isPhone)()||this.readonly){return false}if(this._preventTokenizerToggle){return this._tokenizer.expanded}const e=this._tokenizer?.expanded;const t=this.focused||this.open||e;return t}get _valueStatePopoverHorizontalAlign(){return this.effectiveDir!=="rtl"?"Left":"Right"}get iconsCount(){const e=this.icon?.length||0;const t=this.readonly?0:1;return e+t}get classes(){return{popover:{"ui5-multi-combobox-all-items-responsive-popover":true,"ui5-suggestions-popover":true,"ui5-suggestions-popover-with-value-state-header":this.hasValueStateMessage},popoverValueState:{"ui5-valuestatemessage-root":true,"ui5-valuestatemessage-header":true,"ui5-valuestatemessage--success":this.valueState===l.default.Success,"ui5-valuestatemessage--error":this.valueState===l.default.Error,"ui5-valuestatemessage--warning":this.valueState===l.default.Warning,"ui5-valuestatemessage--information":this.valueState===l.default.Information}}}get styles(){const e=parseInt(getComputedStyle(document.documentElement).fontSize);return{popoverValueStateMessage:{width:`${this._listWidth||0}px`,display:this._listWidth===0?"none":"inline-block"},popoverHeader:{"max-width":(0,c.isPhone)()?"100%":`${this._inputWidth}px`},suggestionsPopover:{"min-width":`${this._inputWidth}px`,"max-width":this._inputWidth/e>40?`${this._inputWidth}px`:"40rem"}}}static async onDefine(){X.i18nBundle=await(0,f.getI18nBundle)("@ui5/webcomponents")}};Y([(0,s.default)()],J.prototype,"value",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"noTypeahead",void 0);Y([(0,s.default)()],J.prototype,"placeholder",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"allowCustomValues",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"disabled",void 0);Y([(0,s.default)({type:l.default,defaultValue:l.default.None})],J.prototype,"valueState",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"readonly",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"required",void 0);Y([(0,s.default)({type:K.default,defaultValue:K.default.StartsWithPerTerm})],J.prototype,"filter",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"open",void 0);Y([(0,s.default)()],J.prototype,"accessibleName",void 0);Y([(0,s.default)()],J.prototype,"accessibleNameRef",void 0);Y([(0,s.default)({type:Object,noAttribute:true,multiple:true})],J.prototype,"_filteredItems",void 0);Y([(0,s.default)({type:Object,noAttribute:true,multiple:true})],J.prototype,"_previouslySelectedItems",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"filterSelected",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"focused",void 0);Y([(0,s.default)({type:Boolean,noAttribute:true})],J.prototype,"_tokenizerFocused",void 0);Y([(0,s.default)({type:Boolean,noAttribute:true})],J.prototype,"_iconPressed",void 0);Y([(0,s.default)({validator:h.default,noAttribute:true})],J.prototype,"_inputWidth",void 0);Y([(0,s.default)({validator:h.default,noAttribute:true,defaultValue:0})],J.prototype,"_listWidth",void 0);Y([(0,s.default)({type:Boolean,noAttribute:true})],J.prototype,"_performingSelectionTwice",void 0);Y([(0,s.default)({type:Boolean})],J.prototype,"tokenizerAvailable",void 0);Y([(0,o.default)({type:HTMLElement,default:true,invalidateOnChildChange:true})],J.prototype,"items",void 0);Y([(0,o.default)()],J.prototype,"icon",void 0);Y([(0,o.default)()],J.prototype,"valueStateMessage",void 0);J=X=Y([(0,i.default)({tag:"ui5-multi-combobox",languageAware:true,renderer:r.default,template:L.default,staticAreaTemplate:F.default,styles:N.default,staticAreaStyles:[U.default,W.default,H.default,G.default],dependencies:[w.default,x.default,P.default,A.default,C.default,D.default,E.default,B.default,R.default,k.default,z.default,V.default]}),(0,n.default)("change"),(0,n.default)("input"),(0,n.default)("open-change"),(0,n.default)("selection-change",{detail:{items:{type:Array}}})],J);J.define();var Q=J;e.default=Q});
//# sourceMappingURL=MultiComboBox.js.map