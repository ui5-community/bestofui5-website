sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/delegate/ItemNavigation","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/types/NavigationMode","./types/BreadcrumbsDesign","./types/BreadcrumbsSeparatorStyle","./BreadcrumbsItem","./generated/i18n/i18n-defaults","./Link","./Label","./ResponsivePopover","./List","./StandardListItem","./Icon","./Button","sap/ui/webc/common/thirdparty/icons/slim-arrow-down","./generated/templates/BreadcrumbsTemplate.lit","./generated/templates/BreadcrumbsPopoverTemplate.lit","./generated/themes/Breadcrumbs.css","./generated/themes/BreadcrumbsPopover.css"],function(e,t,i,r,s,o,n,a,l,d,c,u,h,p,m,_,f,b,g,v,w,y,I,L,A,R,P,S,k){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=B(t);i=B(i);r=B(r);s=B(s);o=B(o);n=B(n);a=B(a);d=B(d);u=B(u);h=B(h);p=B(p);m=B(m);_=B(_);b=B(b);g=B(g);v=B(v);w=B(w);y=B(y);I=B(I);L=B(L);R=B(R);P=B(P);S=B(S);k=B(k);function B(e){return e&&e.__esModule?e:{default:e}}var E=void 0&&(void 0).__decorate||function(e,t,i,r){var s=arguments.length,o=s<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,n;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)if(n=e[a])o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o;return s>3&&o&&Object.defineProperty(t,i,o),o};var O;let W=O=class e extends t.default{constructor(){super();this._breadcrumbItemWidths=new WeakMap;this._dropdownArrowLinkWidth=0;this._itemNavigation=new n.default(this,{navigationMode:h.default.Horizontal,getItemsCallback:()=>this._getFocusableItems()});this._onResizeHandler=this._updateOverflow.bind(this);this._labelFocusAdaptor={id:`${this._id}-labelWrapper`,getlabelWrapper:this.getCurrentLocationLabelWrapper.bind(this),set _tabIndex(e){const t=this.getlabelWrapper();t&&t.setAttribute("tabindex",e)},get _tabIndex(){const e=this.getlabelWrapper();return e?.getAttribute("tabindex")||""}}}onInvalidation(e){if(e.reason==="childchange"){const t=this._getItems().indexOf(e.child),i=t<this._overflowSize;if(i){this._overflowSize=t}}}_getItems(){return this.getSlottedNodes("items")}onBeforeRendering(){this._preprocessItems()}onAfterRendering(){this._cacheWidths();this._updateOverflow()}onEnterDOM(){u.default.register(this,this._onResizeHandler)}onExitDOM(){u.default.deregister(this,this._onResizeHandler)}_initItemNavigation(){if(!this._itemNavigation){this._itemNavigation=new n.default(this,{navigationMode:h.default.Horizontal,getItemsCallback:()=>this._getFocusableItems()})}}_getFocusableItems(){const e=this._links;if(!this._isOverflowEmpty){e.unshift(this._dropdownArrowLink)}if(this._endsWithCurrentLocationLabel){e.push(this._labelFocusAdaptor)}return e}_onfocusin(e){const t=e.target,i=this.getCurrentLocationLabelWrapper(),r=t===i?this._labelFocusAdaptor:t;this._itemNavigation.setCurrentItem(r)}_onkeydown(e){const t=this._isDropdownArrowFocused;if((0,l.isShow)(e)&&t&&!this._isOverflowEmpty){e.preventDefault();this._toggleRespPopover();return}if((0,l.isSpace)(e)&&t&&!this._isOverflowEmpty&&!this._isPickerOpen){e.preventDefault();return}if(((0,l.isEnter)(e)||(0,l.isSpace)(e))&&this._isCurrentLocationLabelFocused){this._onLabelPress(e)}}_onkeyup(e){if(this._isDropdownArrowFocused&&(0,l.isSpace)(e)&&!this._isOverflowEmpty&&!this._isPickerOpen){this._openRespPopover()}}_cacheWidths(){const e=this._breadcrumbItemWidths,t=this._getItems(),i=this._currentLocationLabel;for(let i=this._overflowSize;i<t.length;i++){const r=t[i],s=this.shadowRoot.querySelector(`#${r._id}-link-wrapper`);e.set(r,this._getElementWidth(s))}if(t.length&&this._endsWithCurrentLocationLabel&&i){const r=t[t.length-1];e.set(r,this._getElementWidth(i))}if(!this._isOverflowEmpty){const e=this.shadowRoot.querySelector(".ui5-breadcrumbs-dropdown-arrow-link-wrapper");this._dropdownArrowLinkWidth=this._getElementWidth(e)}}_updateOverflow(){const e=this._getItems(),t=this.shadowRoot.querySelector(".ui5-breadcrumbs-root").offsetWidth;let i=this._getTotalContentWidth(),r=0;if(i>t){i+=this._dropdownArrowLinkWidth}while(i>=t&&r<this._maxAllowedOverflowSize){const t=e[r];let s=0;if(this._isItemVisible(t)){s=this._breadcrumbItemWidths.get(t)||0}i-=s;r++}this._overflowSize=r;if(this._isOverflowEmpty&&this._isPickerOpen){this.responsivePopover.close()}const s=this._getFocusableItems();if(!s.some(e=>e._tabIndex==="0")){this._itemNavigation.setCurrentItem(s[0])}}_getElementWidth(e){if(e){return Math.ceil(e.getBoundingClientRect().width)}return 0}_getTotalContentWidth(){const e=this._getItems(),t=this._breadcrumbItemWidths,i=e.reduce((e,i)=>e+t.get(i),0);return i}_onLinkPress(e){const t=e.target,i=this._getItems(),r=i.find(e=>`${e._id}-link`===t.id),{altKey:s,ctrlKey:o,metaKey:n,shiftKey:a}=e.detail;if(!this.fireEvent("item-click",{item:r,altKey:s,ctrlKey:o,metaKey:n,shiftKey:a},true)){e.preventDefault()}}_onLabelPress(e){const t=this._getItems(),i=t[t.length-1],{altKey:r,ctrlKey:s,metaKey:o,shiftKey:n}=e;this.fireEvent("item-click",{item:i,altKey:r,ctrlKey:s,metaKey:o,shiftKey:n})}_onOverflowListItemSelect(e){const t=e.detail.selectedItems[0],i=this._getItems(),r=i.find(e=>`${e._id}-li`===t.id);if(this.fireEvent("item-click",{item:r},true)){window.open(r.href,r.target||"_self","noopener,noreferrer");this.responsivePopover.close()}}async _respPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-responsive-popover]")}async _toggleRespPopover(){this.responsivePopover=await this._respPopover();if(this._isPickerOpen){this._closeRespPopover()}else{this._openRespPopover()}}_closeRespPopover(){this.responsivePopover&&this.responsivePopover.close()}async _openRespPopover(){this.responsivePopover=await this._respPopover();this.responsivePopover.showAt(this._dropdownArrowLink)}_isItemVisible(e){return!e.hidden&&this._hasVisibleContent(e)}_hasVisibleContent(e){return e.innerText||Array.from(e.children).some(e=>!e.hidden)}_preprocessItems(){this.items.forEach(e=>{e._getRealDomRef=()=>this.getDomRef().querySelector(`[data-ui5-stable*=${e.stableDomRef}]`)})}_getItemPositionText(e,t){return O.i18nBundle.getText(f.BREADCRUMB_ITEM_POS,e,t)}_getItemAccessibleName(e,t,i){const r=this._getItemPositionText(t,i);const s=e.textContent||"";let o="";if(e.accessibleName){o=`${s.trim()} ${e.accessibleName} ${r}`}else{o=`${s.trim()} ${r}`}return o}getCurrentLocationLabelWrapper(){return this.shadowRoot.querySelector(".ui5-breadcrumbs-current-location > span")}get _visibleItems(){return this._getItems().slice(this._overflowSize).filter(e=>this._isItemVisible(e))}get _endsWithCurrentLocationLabel(){return this.design===p.default.Standard}get _currentLocationText(){const e=this._getItems();if(this._endsWithCurrentLocationLabel&&e.length){const t=e[e.length-1];if(this._isItemVisible(t)){return t.innerText}}return""}get _currentLocationLabel(){return this.shadowRoot.querySelector(".ui5-breadcrumbs-current-location [ui5-label]")}get _isDropdownArrowFocused(){return this._dropdownArrowLink._tabIndex==="0"}get _isCurrentLocationLabelFocused(){const e=this.getCurrentLocationLabelWrapper();return e&&e.tabIndex===0}get _maxAllowedOverflowSize(){const e=this._getItems().filter(e=>this._isItemVisible(e));return e.length-1}get _dropdownArrowLink(){return this.shadowRoot.querySelector(".ui5-breadcrumbs-dropdown-arrow-link-wrapper [ui5-link]")}get _overflowItemsData(){return this._getItems().slice(0,this._overflowSize).filter(e=>this._isItemVisible(e)).reverse()}get _linksData(){const e=this._visibleItems;const t=e.length;if(this._endsWithCurrentLocationLabel){e.pop()}return e.map((e,i)=>{e._accessibleNameText=this._getItemAccessibleName(e,i+1,t);return e})}get _currentLocationAccName(){const e=this._visibleItems;const t=this._getItemPositionText(e.length,e.length);const i=e[e.length-1];if(!i){return t}const r=i.textContent||"";if(i.accessibleName){return`${r.trim()} ${i.accessibleName} ${t}`}return`${r.trim()} ${t}`}get _links(){return Array.from(this.shadowRoot.querySelectorAll(".ui5-breadcrumbs-link-wrapper [ui5-link]"))}get _isOverflowEmpty(){return this._overflowItemsData.length===0}get _ariaHasPopup(){if(!this._isOverflowEmpty){return"listbox"}return undefined}get _isPickerOpen(){return!!this.responsivePopover&&this.responsivePopover.opened}get _accessibleNameText(){return O.i18nBundle.getText(f.BREADCRUMBS_ARIA_LABEL)}get _dropdownArrowAccessibleNameText(){return O.i18nBundle.getText(f.BREADCRUMBS_OVERFLOW_ARIA_LABEL)}get _cancelButtonText(){return O.i18nBundle.getText(f.BREADCRUMBS_CANCEL_BUTTON)}static async onDefine(){O.i18nBundle=await(0,c.getI18nBundle)("@ui5/webcomponents")}};E([(0,r.default)({type:p.default,defaultValue:p.default.Standard})],W.prototype,"design",void 0);E([(0,r.default)({type:m.default,defaultValue:m.default.Slash})],W.prototype,"separatorStyle",void 0);E([(0,r.default)({validator:d.default,noAttribute:true,defaultValue:0})],W.prototype,"_overflowSize",void 0);E([(0,s.default)({type:HTMLElement,invalidateOnChildChange:true,default:true})],W.prototype,"items",void 0);W=O=E([(0,i.default)({tag:"ui5-breadcrumbs",languageAware:true,renderer:a.default,template:R.default,staticAreaTemplate:P.default,styles:S.default,staticAreaStyles:k.default,dependencies:[_.default,b.default,g.default,v.default,w.default,y.default,I.default,L.default]}),(0,o.default)("item-click",{detail:{item:{type:HTMLElement},altKey:{type:Boolean},ctrlKey:{type:Boolean},metaKey:{type:Boolean},shiftKey:{type:Boolean}}})],W);W.define();var x=W;e.default=x});
//# sourceMappingURL=Breadcrumbs.js.map