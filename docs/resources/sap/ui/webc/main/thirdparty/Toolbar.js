sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/renderer/executeTemplate","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/Render","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/icons/overflow","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/CustomElementsScope","./generated/i18n/i18n-defaults","./generated/templates/ToolbarTemplate.lit","./generated/themes/Toolbar.css","./generated/templates/ToolbarPopoverTemplate.lit","./generated/themes/ToolbarPopover.css","./types/ToolbarAlign","./types/ToolbarItemOverflowBehavior","./types/HasPopup","./ToolbarRegistry","./Button","./Popover"],function(e,t,i,r,o,s,a,n,l,u,h,d,c,f,p,m,v,w,g,b,O,y,I,T,S){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=B(t);i=B(i);r=B(r);o=B(o);s=B(s);a=B(a);l=B(l);h=B(h);m=B(m);v=B(v);w=B(w);g=B(g);b=B(b);O=B(O);y=B(y);T=B(T);S=B(S);function B(e){return e&&e.__esModule?e:{default:e}}var A=void 0&&(void 0).__decorate||function(e,t,i,r){var o=arguments.length,s=o<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,i,r);else for(var n=e.length-1;n>=0;n--)if(a=e[n])s=(o<3?a(s):o>3?a(t,i,s):a(t,i))||s;return o>3&&s&&Object.defineProperty(t,i,s),s};var R;function _(e,t){return Number(e.getPropertyValue(t).replace("rem",""))*parseInt(getComputedStyle(document.body).getPropertyValue("font-size"))}function E(e,t){return Number(e.getPropertyValue(t).replace("px",""))}let M=R=class e extends t.default{static get styles(){const e=(0,I.getRegisteredStyles)();return[v.default,...e]}static get staticAreaStyles(){const e=(0,I.getRegisteredStaticAreaStyles)();return[g.default,...e]}static get dependencies(){const e=(0,I.getRegisteredDependencies)();return[S.default,T.default,...e]}static async onDefine(){R.i18nBundle=await(0,c.getI18nBundle)("@ui5/webcomponents")}constructor(){super();this.itemsToOverflow=[];this.itemsWidth=0;this.popoverOpen=false;this.itemsWidthMeasured=false;this.ITEMS_WIDTH_MAP=new Map;this._onResize=this.onResize.bind(this);this._onInteract=e=>this.onInteract(e)}get overflowButtonSize(){return this.overflowButtonDOM?.getBoundingClientRect().width||0}get padding(){const e=getComputedStyle(this.getDomRef());return _(e,(0,f.getScopedVarName)("--_ui5-toolbar-padding-left"))+_(e,(0,f.getScopedVarName)("--_ui5-toolbar-padding-right"))}get subscribedEvents(){return this.items.map(e=>Array.from(e.subscribedEvents.keys())).flat().filter((e,t,i)=>i.indexOf(e)===t)}get alwaysOverflowItems(){return this.items.filter(e=>e.overflowPriority===O.default.AlwaysOverflow)}get movableItems(){return this.items.filter(e=>e.overflowPriority!==O.default.AlwaysOverflow&&e.overflowPriority!==O.default.NeverOverflow)}get overflowItems(){const e=this.getItemsInfo(this.itemsToOverflow.filter(e=>!e.ignoreSpace));return this.reverseOverflow?e.reverse():e}get standardItems(){return this.getItemsInfo(this.items.filter(e=>this.itemsToOverflow.indexOf(e)===-1))}get hideOverflowButton(){return this.itemsToOverflow.filter(e=>!(e.ignoreSpace||e.isSeparator)).length===0}get classes(){return{items:{"ui5-tb-items":true,"ui5-tb-items-full-width":this.hasFlexibleSpacers},overflow:{"ui5-overflow-list--alignleft":this.hasItemWithText},overflowButton:{"ui5-tb-item":true,"ui5-tb-overflow-btn":true,"ui5-tb-overflow-btn-hidden":this.hideOverflowButton}}}get interactiveItemsCount(){return this.items.filter(e=>e.isInteractive).length}get hasAriaSemantics(){return this.interactiveItemsCount>1}get accessibleRole(){return this.hasAriaSemantics?"toolbar":undefined}get ariaLabelText(){return this.hasAriaSemantics?(0,u.getEffectiveAriaLabelText)(this):undefined}get accInfo(){return{root:{role:this.accessibleRole,accessibleName:this.ariaLabelText},overflowButton:{accessibleName:R.i18nBundle.getText(p.TOOLBAR_OVERFLOW_BUTTON_ARIA_LABEL),tooltip:R.i18nBundle.getText(p.TOOLBAR_OVERFLOW_BUTTON_ARIA_LABEL),accessibilityAttributes:{expanded:this.overflowButtonDOM?.accessibilityAttributes.expanded,hasPopup:y.default.Menu}}}}get overflowButtonDOM(){return this.shadowRoot.querySelector(".ui5-tb-overflow-btn")}get itemsDOM(){return this.shadowRoot.querySelector(".ui5-tb-items")}get hasItemWithText(){return this.itemsToOverflow.some(e=>e.containsText)}get hasFlexibleSpacers(){return this.items.some(e=>e.hasFlexibleWidth)}onEnterDOM(){l.default.register(this,this._onResize)}onExitDOM(){l.default.deregister(this,this._onResize)}onInvalidation(e){if(e.reason==="childchange"&&e.child===this.itemsToOverflow[0]){this.onToolbarItemChange()}}onBeforeRendering(){this.detachListeners();this.attachListeners()}async onAfterRendering(){await(0,n.renderFinished)();this.storeItemsWidth();this.processOverflowLayout()}async isOverflowOpen(){const e=await this.getOverflowPopover();return e.isOpen()}async openOverflow(){const e=await this.getOverflowPopover();e.showAt(this.overflowButtonDOM);this.reverseOverflow=e.actualPlacementType==="Top"}async closeOverflow(){const e=await this.getOverflowPopover();e.close()}toggleOverflow(){if(this.popoverOpen){this.closeOverflow()}else{this.openOverflow()}}async getOverflowPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector(".ui5-overflow-popover")}processOverflowLayout(){const e=this.offsetWidth-this.padding;const t=this.itemsWidth;const i=t-e+this.overflowButtonSize;if(this.width===e&&this.contentWidth===t){return}this.distributeItems(i);this.width=e;this.contentWidth=t}storeItemsWidth(){let e=0;this.items.forEach(t=>{const i=this.getItemWidth(t);e+=i;this.ITEMS_WIDTH_MAP.set(t._id,i)});this.itemsWidth=e}distributeItems(e=0){const t=this.movableItems.reverse();let i=0;let r=t[i];this.itemsToOverflow=[];this.distributeItemsThatAlwaysOverflow();while(e>0&&r){this.itemsToOverflow.unshift(r);e-=this.getCachedItemWidth(r?._id)||0;i++;r=t[i]}if(i<t.length){let e=t[i];while(i<=t.length-1&&e.isSeparator){this.itemsToOverflow.unshift(e);i++;e=t[i]}}this.setSeperatorsVisibilityInOverflow()}distributeItemsThatAlwaysOverflow(){this.alwaysOverflowItems.forEach(e=>{this.itemsToOverflow.push(e)})}setSeperatorsVisibilityInOverflow(){this.itemsToOverflow.forEach((e,t,i)=>{if(e.isSeparator){e.visible=this.shouldShowSeparatorInOverflow(t,i)}})}shouldShowSeparatorInOverflow(e,t){let i=false;let r=false;t.forEach((t,o)=>{if(o<e&&!t.isSeparator){i=true}if(o>e&&!t.isSeparator){r=true}});return i&&r}onOverflowPopoverClosed(){this.popoverOpen=false;if(this.overflowButtonDOM){this.overflowButtonDOM.accessibilityAttributes.expanded="false"}}onOverflowPopoverOpened(){this.popoverOpen=true;if(this.overflowButtonDOM){this.overflowButtonDOM.accessibilityAttributes.expanded="true"}}onResize(){if(!this.itemsWidth){return}this.closeOverflow();this.processOverflowLayout()}onInteract(e){const t=e.target;const i=t.closest(".ui5-tb-item")||t.closest(".ui5-tb-popover-item");const r=e.type;if(t===this.overflowButtonDOM){this.toggleOverflow();return}if(!i){return}const o=t.getAttribute("data-ui5-external-action-item-id");if(o){const t=this.getItemByID(o);const i=!t?.fireEvent(r,e.detail,true);const s=t?.subscribedEvents.get(r);if(i||t?.preventOverflowClosing||s?.preventClosing){return}this.closeOverflow()}}async attachListeners(){const e=await this.getOverflowPopover();this.subscribedEvents.forEach(t=>{this.itemsDOM?.addEventListener(t,this._onInteract);e?.addEventListener(t,this._onInteract)})}async detachListeners(){const e=await this.getOverflowPopover();this.subscribedEvents.forEach(t=>{this.itemsDOM?.removeEventListener(t,this._onInteract);e?.removeEventListener(t,this._onInteract)})}onToolbarItemChange(){this.itemsToOverflow=[];this.contentWidth=0}getItemsInfo(e){return e.map(e=>{const t=(0,I.getRegisteredToolbarItem)(e.constructor.name);if(!t){return null}const i={toolbarTemplate:(0,s.default)(t.toolbarTemplate,e),toolbarPopoverTemplate:(0,s.default)(t.toolbarPopoverTemplate,e)};return i})}getItemWidth(e){if(e.ignoreSpace||e.isSeparator){return 0}const t=e._id;const i=this.getRegisteredToolbarItemByID(t);let r=0;if(i){const e=getComputedStyle(i);r=i.offsetWidth+E(e,"margin-inline-end")+E(e,"margin-inline-start")}else{r=this.getCachedItemWidth(t)||0}return Math.ceil(r)}getCachedItemWidth(e){return this.ITEMS_WIDTH_MAP.get(e)}getItemByID(e){return this.items.find(t=>t._id===e)}getRegisteredToolbarItemByID(e){return this.itemsDOM.querySelector(`[data-ui5-external-action-item-id="${e}"]`)}};A([(0,r.default)({type:b.default,defaultValue:b.default.End})],M.prototype,"alignContent",void 0);A([(0,r.default)({type:h.default})],M.prototype,"width",void 0);A([(0,r.default)({type:h.default})],M.prototype,"contentWidth",void 0);A([(0,r.default)({type:Boolean})],M.prototype,"reverseOverflow",void 0);A([(0,r.default)()],M.prototype,"accessibleName",void 0);A([(0,r.default)({defaultValue:""})],M.prototype,"accessibleNameRef",void 0);A([(0,i.default)({default:true,type:HTMLElement,invalidateOnChildChange:true})],M.prototype,"items",void 0);M=R=A([(0,o.default)({tag:"ui5-toolbar",languageAware:true,renderer:a.default,template:m.default,staticAreaTemplate:w.default})],M);M.define();var P=M;e.default=P});
//# sourceMappingURL=Toolbar.js.map