sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/event","sap/ui/webc/common/thirdparty/base/decorators/slot","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/connectToComponent","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/types/DOMReference","sap/ui/webc/common/thirdparty/base/util/InvisibleMessage","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/types/ValueState","sap/ui/webc/common/thirdparty/icons/slim-arrow-down","sap/ui/webc/common/thirdparty/icons/error","sap/ui/webc/common/thirdparty/icons/alert","sap/ui/webc/common/thirdparty/icons/sys-enter-2","sap/ui/webc/common/thirdparty/icons/information","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/icons/decline","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/types/InvisibleMessageMode","sap/ui/webc/common/thirdparty/base/CustomElementsScope","./List","./generated/i18n/i18n-defaults","./Option","./Label","./ResponsivePopover","./Popover","./StandardListItem","./Icon","./Button","./generated/templates/SelectTemplate.lit","./generated/templates/SelectPopoverTemplate.lit","./generated/themes/Select.css","./generated/themes/ResponsivePopoverCommon.css","./generated/themes/ValueStateMessage.css","./generated/themes/SelectPopover.css"],function(e,t,s,i,n,o,a,l,r,d,u,c,h,p,f,_,v,g,m,S,y,x,I,b,O,T,P,M,E,C,w,L,R,A,D,V,B,N,k,W){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=U(t);s=U(s);i=U(i);n=U(n);o=U(o);a=U(a);l=U(l);d=U(d);u=U(u);p=U(p);I=U(I);b=U(b);T=U(T);M=U(M);E=U(E);C=U(C);w=U(w);L=U(L);R=U(R);A=U(A);D=U(D);V=U(V);B=U(B);N=U(N);k=U(k);W=U(W);function U(e){return e&&e.__esModule?e:{default:e}}var $=void 0&&(void 0).__decorate||function(e,t,s,i){var n=arguments.length,o=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,s,i);else for(var l=e.length-1;l>=0;l--)if(a=e[l])o=(n<3?a(o):n>3?a(t,s,o):a(t,s))||o;return n>3&&o&&Object.defineProperty(t,s,o),o};var H;let F=H=class e extends t.default{constructor(){super();this._syncedOptions=[];this._selectedIndexBeforeOpen=-1;this._escapePressed=false;this._lastSelectedOption=null;this._typedChars="";this._onMenuClick=this.onMenuClick.bind(this);this._onMenuClose=this.onMenuClose.bind(this);this._onMenuOpen=this.onMenuOpen.bind(this);this._onMenuBeforeOpen=this.onMenuBeforeOpen.bind(this);this._onMenuChange=this.onMenuChange.bind(this);this._attachMenuListeners=this.attachMenuListeners.bind(this);this._detachMenuListeners=this.detachMenuListeners.bind(this)}onBeforeRendering(){const e=this._getSelectMenu();if(e){e.value=this.value}else{this._syncSelection()}this._enableFormSupport();this.style.setProperty((0,O.getScopedVarName)("--_ui5-input-icons-count"),`${this.iconsCount}`)}onAfterRendering(){this.toggleValueStatePopover(this.shouldOpenValueStateMessagePopover);if(this._isPickerOpen){if(!this._listWidth){this._listWidth=this.responsivePopover.offsetWidth}}this._attachRealDomRefs()}_onfocusin(){this.focused=true}_onfocusout(){this.focused=false}get _isPickerOpen(){const e=this._getSelectMenu();if(e){return e.open}return!!this.responsivePopover&&this.responsivePopover.opened}async _respPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-responsive-popover]")}get selectedOption(){return this.selectOptions.find(e=>e.selected)}onMenuClick(e){const t=e.detail.optionIndex;this._handleSelectionChange(t)}onMenuBeforeOpen(){this._beforeOpen()}onMenuOpen(){this._afterOpen()}onMenuClose(){this._afterClose()}onMenuChange(e){this._text=e.detail.text;this._selectedIndex=e.detail.selectedIndex}_toggleSelectMenu(){const e=this._getSelectMenu();if(!e){return}if(e.open){e.close()}else{e.showAt(this,this.offsetWidth)}}onExitDOM(){const e=this._getSelectMenu();if(e){this._detachMenuListeners(e)}}async _toggleRespPopover(){if(this.disabled){return}this._iconPressed=true;const e=this._getSelectMenu();if(e){this._toggleSelectMenu();return}this.responsivePopover=await this._respPopover();if(this._isPickerOpen){this.responsivePopover.close()}else{this.responsivePopover.showAt(this)}}async _attachRealDomRefs(){this.responsivePopover=await this._respPopover();this.options.forEach(e=>{e._getRealDomRef=()=>this.responsivePopover.querySelector(`*[data-ui5-stable=${e.stableDomRef}]`)})}_syncSelection(){let e=-1,t=-1;const s=this._filteredItems;const i=s.map((s,i)=>{if(s.selected||s.textContent===this.value){e=i}if(t===-1){t=i}s.selected=false;s._focused=false;return{selected:false,_focused:false,icon:s.icon,value:s.value,textContent:s.textContent,title:s.title,additionalText:s.additionalText,id:s._id,stableDomRef:s.stableDomRef}});if(e>-1){i[e].selected=true;i[e]._focused=true;s[e].selected=true;s[e]._focused=true;this._text=i[e].textContent;this._selectedIndex=e}else{this._text="";this._selectedIndex=-1;if(i[t]){i[t].selected=true;i[t]._focused=true;s[t].selected=true;s[t]._focused=true;this._selectedIndex=t;this._text=s[t].textContent}}this._syncedOptions=i}_getSelectMenu(){return(0,l.default)({host:this,propName:"menu",onConnect:this._attachMenuListeners,onDisconnect:this._detachMenuListeners})}attachMenuListeners(e){e.addEventListener("ui5-after-close",this._onMenuClose);e.addEventListener("ui5-after-open",this._onMenuOpen);e.addEventListener("ui5-before-open",this._onMenuBeforeOpen);e.addEventListener("ui5-option-click",this._onMenuClick);e.addEventListener("ui5-menu-change",this._onMenuChange)}detachMenuListeners(e){e.removeEventListener("ui5-after-close",this._onMenuClose);e.removeEventListener("ui5-after-open",this._onMenuOpen);e.removeEventListener("ui5-before-open",this._onMenuBeforeOpen);e.removeEventListener("ui5-option-click",this._onMenuClick);e.removeEventListener("ui5-menu-change",this._onMenuChange)}_enableFormSupport(){const e=(0,c.getFeature)("FormSupport");if(e){e.syncNativeHiddenInput(this,(e,t)=>{const s=e;t.disabled=!!e.disabled;t.value=s._currentlySelectedOption?s._currentlySelectedOption.value:""})}else if(this.name){console.warn(`In order for the "name" property to have effect, you should also: import "@ui5/webcomponents/dist/features/InputElementsFormSupport.js";`)}}_onkeydown(e){const t=(0,r.isTabNext)(e)||(0,r.isTabPrevious)(e);if(t&&this._isPickerOpen){const e=this._getSelectMenu();if(e){e.close(false,false,true)}else{this.responsivePopover.close()}}else if((0,r.isShow)(e)){e.preventDefault();this._toggleRespPopover()}else if((0,r.isSpace)(e)){e.preventDefault()}else if((0,r.isEscape)(e)&&this._isPickerOpen){this._escapePressed=true}else if((0,r.isHome)(e)){this._handleHomeKey(e)}else if((0,r.isEnd)(e)){this._handleEndKey(e)}else if((0,r.isEnter)(e)){this._handleSelectionChange()}else if((0,r.isUp)(e)||(0,r.isDown)(e)){this._handleArrowNavigation(e)}}_handleKeyboardNavigation(e){if((0,r.isEnter)(e)){return}const t=e.key.toLowerCase();this._typedChars+=t;const s=/^(.)\1+$/i.test(this._typedChars)?t:this._typedChars;clearTimeout(this._typingTimeoutID);this._typingTimeoutID=setTimeout(()=>{this._typedChars="";this._typingTimeoutID=-1},1e3);this._selectTypedItem(s)}_selectTypedItem(e){const t=this._selectedIndex;const s=this._searchNextItemByText(e);if(s){const e=this.selectOptions.indexOf(s);this._changeSelectedItem(this._selectedIndex,e);if(t!==this._selectedIndex){this.itemSelectionAnnounce()}}}_searchNextItemByText(e){let t=this.selectOptions.slice(0);const s=t.splice(this._selectedIndex+1,t.length-this._selectedIndex);const i=t.splice(0,t.length-1);t=s.concat(i);return t.find(t=>(t.displayText||t.textContent||"").toLowerCase().startsWith(e))}_handleHomeKey(e){e.preventDefault();this._changeSelectedItem(this._selectedIndex,0)}_handleEndKey(e){const t=this.selectOptions.length-1;e.preventDefault();this._changeSelectedItem(this._selectedIndex,t)}_onkeyup(e){if((0,r.isSpace)(e)){if(this._isPickerOpen){this._handleSelectionChange()}else{this._toggleRespPopover()}}}_getSelectedItemIndex(e){return this.selectOptions.findIndex(t=>`${t._id}-li`===e.id)}_select(e){this.selectOptions[this._selectedIndex].selected=false;if(this._selectedIndex!==e){this.fireEvent("live-change",{selectedOption:this.selectOptions[e]})}this._selectedIndex=e;this.selectOptions[e].selected=true}_handleItemPress(e){const t=e.detail.item;const s=this._getSelectedItemIndex(t);this._handleSelectionChange(s)}_itemMousedown(e){e.preventDefault()}_onclick(){this.getFocusDomRef().focus();this._toggleRespPopover()}_handleSelectionChange(e=this._selectedIndex){this._select(e);this._toggleRespPopover()}_scrollSelectedItem(){if(this._isPickerOpen){const e=this._currentlySelectedOption?.getDomRef();if(e){e.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})}}}_handleArrowNavigation(e){let t=-1;const s=this._selectedIndex;const i=(0,r.isDown)(e);e.preventDefault();if(i){t=this._getNextOptionIndex()}else{t=this._getPreviousOptionIndex()}this._changeSelectedItem(this._selectedIndex,t);if(s!==this._selectedIndex){this.itemSelectionAnnounce();this._scrollSelectedItem()}}_changeSelectedItem(e,t){const s=this.selectOptions;const i=s[e];i.selected=false;i._focused=false;i.focused=false;const n=s[t];n.selected=true;n._focused=true;n.focused=true;this._selectedIndex=t;this.fireEvent("live-change",{selectedOption:n});if(!this._isPickerOpen){this._fireChangeEvent(n)}}_getNextOptionIndex(){const e=this._getSelectMenu();if(e){return this._selectedIndex===e.options.length-1?this._selectedIndex:this._selectedIndex+1}return this._selectedIndex===this.options.length-1?this._selectedIndex:this._selectedIndex+1}_getPreviousOptionIndex(){return this._selectedIndex===0?this._selectedIndex:this._selectedIndex-1}_beforeOpen(){this._selectedIndexBeforeOpen=this._selectedIndex;this._lastSelectedOption=this.selectOptions[this._selectedIndex]}_afterOpen(){this.opened=true;this.fireEvent("open");this.itemSelectionAnnounce();this._scrollSelectedItem()}_afterClose(){this.opened=false;this._iconPressed=false;this._listWidth=0;if(this._escapePressed){this._select(this._selectedIndexBeforeOpen);this._escapePressed=false}else if(this._lastSelectedOption!==this.selectOptions[this._selectedIndex]){this._fireChangeEvent(this.selectOptions[this._selectedIndex]);this._lastSelectedOption=this.selectOptions[this._selectedIndex]}this.fireEvent("close")}get selectOptions(){const e=this._getSelectMenu();if(e){return e.options}return this._filteredItems}get hasCustomLabel(){return!!this.label.length}_fireChangeEvent(e){const t=!this.fireEvent("change",{selectedOption:e},true);this.selectedItem=e.textContent;this.fireEvent("selected-item-changed");if(t){this.selectedItem=this._lastSelectedOption.textContent;this._select(this._selectedIndexBeforeOpen)}}get valueStateTextMappings(){return{[p.default.Success]:H.i18nBundle.getText(P.VALUE_STATE_SUCCESS),[p.default.Information]:H.i18nBundle.getText(P.VALUE_STATE_INFORMATION),[p.default.Error]:H.i18nBundle.getText(P.VALUE_STATE_ERROR),[p.default.Warning]:H.i18nBundle.getText(P.VALUE_STATE_WARNING)}}get valueStateTypeMappings(){return{[p.default.Success]:H.i18nBundle.getText(P.VALUE_STATE_TYPE_SUCCESS),[p.default.Information]:H.i18nBundle.getText(P.VALUE_STATE_TYPE_INFORMATION),[p.default.Error]:H.i18nBundle.getText(P.VALUE_STATE_TYPE_ERROR),[p.default.Warning]:H.i18nBundle.getText(P.VALUE_STATE_TYPE_WARNING)}}get valueStateText(){let e;if(this.shouldDisplayDefaultValueStateMessage){e=this.valueStateDefaultText}else{e=this.valueStateMessageText.map(e=>e.textContent).join(" ")}return`${this.valueStateTypeText} ${e}`}get valueStateDefaultText(){return this.valueState!==p.default.None?this.valueStateTextMappings[this.valueState]:""}get valueStateTypeText(){return this.valueState!==p.default.None?this.valueStateTypeMappings[this.valueState]:""}get hasValueState(){return this.valueState!==p.default.None}get valueStateTextId(){return this.hasValueState?`${this._id}-valueStateDesc`:undefined}get isDisabled(){return this.disabled||undefined}get _headerTitleText(){return H.i18nBundle.getText(P.INPUT_SUGGESTIONS_TITLE)}get _currentlySelectedOption(){return this.selectOptions[this._selectedIndex]}get _effectiveTabIndex(){return this.disabled||this.responsivePopover&&this.responsivePopover.opened?"-1":"0"}get _valueStateMessageInputIcon(){const e={Error:"error",Warning:"alert",Success:"sys-enter-2",Information:"information"};return this.valueState!==p.default.None?e[this.valueState]:""}get iconsCount(){return this.selectedOptionIcon?2:1}get classes(){return{popoverValueState:{"ui5-valuestatemessage-root":true,"ui5-valuestatemessage--success":this.valueState===p.default.Success,"ui5-valuestatemessage--error":this.valueState===p.default.Error,"ui5-valuestatemessage--warning":this.valueState===p.default.Warning,"ui5-valuestatemessage--information":this.valueState===p.default.Information},popover:{"ui5-select-popover-valuestate":this.hasValueState}}}get styles(){return{popoverHeader:{"max-width":`${this.offsetWidth}px`},responsivePopoverHeader:{display:this._filteredItems.length&&this._listWidth===0?"none":"inline-block",width:`${this._filteredItems.length?this._listWidth:this.offsetWidth}px`},responsivePopover:{"min-width":`${this.offsetWidth}px`}}}get ariaLabelText(){return(0,h.getEffectiveAriaLabelText)(this)}get valueStateMessageText(){return this.getSlottedNodes("valueStateMessage").map(e=>e.cloneNode(true))}get shouldDisplayDefaultValueStateMessage(){return!this.valueStateMessageText.length&&this.hasValueStateText}get hasValueStateText(){return this.hasValueState&&this.valueState!==p.default.Success}get shouldOpenValueStateMessagePopover(){return this.focused&&this.hasValueStateText&&!this._iconPressed&&!this._isPickerOpen&&!this._isPhone}get _ariaRoleDescription(){return H.i18nBundle.getText(P.SELECT_ROLE_DESCRIPTION)}get _isPhone(){return(0,S.isPhone)()}get _filteredItems(){return this.options.filter(e=>!e.disabled)}itemSelectionAnnounce(){let e;const t=this.selectOptions.length;const s=H.i18nBundle.getText(P.LIST_ITEM_POSITION,this._selectedIndex+1,t);if(this.focused&&this._currentlySelectedOption){e=`${this._currentlySelectedOption.textContent} ${this._isPickerOpen?s:""}`;(0,u.default)(e,b.default.Polite)}}async openValueStatePopover(){this.valueStatePopover=await this._getPopover();if(this.valueStatePopover){this.valueStatePopover.showAt(this)}}closeValueStatePopover(){this.valueStatePopover&&this.valueStatePopover.close()}toggleValueStatePopover(e){if(e){this.openValueStatePopover()}else{this.closeValueStatePopover()}}get selectedOptionIcon(){return this.selectedOption&&this.selectedOption.icon}async _getPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-popover]")}static async onDefine(){H.i18nBundle=await(0,y.getI18nBundle)("@ui5/webcomponents")}};$([(0,i.default)({validator:d.default})],F.prototype,"menu",void 0);$([(0,i.default)({type:Boolean})],F.prototype,"disabled",void 0);$([(0,i.default)()],F.prototype,"name",void 0);$([(0,i.default)({type:p.default,defaultValue:p.default.None})],F.prototype,"valueState",void 0);$([(0,i.default)({type:Boolean})],F.prototype,"required",void 0);$([(0,i.default)()],F.prototype,"accessibleName",void 0);$([(0,i.default)()],F.prototype,"accessibleNameRef",void 0);$([(0,i.default)({type:String,noAttribute:true})],F.prototype,"_text",void 0);$([(0,i.default)({type:Boolean,noAttribute:true})],F.prototype,"_iconPressed",void 0);$([(0,i.default)({type:Boolean})],F.prototype,"opened",void 0);$([(0,i.default)({validator:I.default,defaultValue:0,noAttribute:true})],F.prototype,"_listWidth",void 0);$([(0,i.default)({type:Boolean})],F.prototype,"focused",void 0);$([(0,i.default)({validator:I.default,defaultValue:-1,noAttribute:true})],F.prototype,"_selectedIndex",void 0);$([(0,o.default)({default:true,type:HTMLElement,invalidateOnChildChange:true})],F.prototype,"options",void 0);$([(0,o.default)()],F.prototype,"formSupport",void 0);$([(0,o.default)()],F.prototype,"valueStateMessage",void 0);$([(0,o.default)()],F.prototype,"label",void 0);F=H=$([(0,s.default)({tag:"ui5-select",languageAware:true,renderer:a.default,template:D.default,staticAreaTemplate:V.default,styles:B.default,staticAreaStyles:[N.default,k.default,W.default],dependencies:[M.default,E.default,C.default,w.default,T.default,L.default,R.default,A.default]}),(0,n.default)("change",{detail:{selectedOption:{type:HTMLElement}}}),(0,n.default)("live-change",{detail:{option:{type:HTMLElement}}}),(0,n.default)("open"),(0,n.default)("close")],F);F.define();var j=F;e.default=j});
//# sourceMappingURL=Select.js.map