sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/main/thirdparty/Dialog","sap/ui/webc/main/thirdparty/Button","sap/ui/webc/main/thirdparty/BusyIndicator","sap/ui/webc/fiori/lib/zxing","sap/ui/webc/common/thirdparty/base/decorators/customElement","sap/ui/webc/common/thirdparty/base/decorators/property","sap/ui/webc/common/thirdparty/base/decorators/event","./generated/i18n/i18n-defaults","./generated/templates/BarcodeScannerDialogTemplate.lit","./generated/themes/BarcodeScannerDialog.css"],function(e,t,a,r,i,n,s,o,c,d,l,u,f,g){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=m(t);a=m(a);i=m(i);n=m(n);s=m(s);o=h(o);c=m(c);d=m(d);l=m(l);f=m(f);g=m(g);function p(e){if(typeof WeakMap!=="function")return null;var t=new WeakMap;var a=new WeakMap;return(p=function(e){return e?a:t})(e)}function h(e,t){if(!t&&e&&e.__esModule){return e}if(e===null||typeof e!=="object"&&typeof e!=="function"){return{default:e}}var a=p(t);if(a&&a.has(e)){return a.get(e)}var r={};var i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e){if(n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)){var s=i?Object.getOwnPropertyDescriptor(e,n):null;if(s&&(s.get||s.set)){Object.defineProperty(r,n,s)}else{r[n]=e[n]}}}r.default=e;if(a){a.set(e,r)}return r}function m(e){return e&&e.__esModule?e:{default:e}}var y=void 0&&(void 0).__decorate||function(e,t,a,r){var i=arguments.length,n=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,a):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(e,t,a,r);else for(var o=e.length-1;o>=0;o--)if(s=e[o])n=(i<3?s(n):i>3?s(t,a,n):s(t,a))||n;return i>3&&n&&Object.defineProperty(t,a,n),n};var _;const w={...o,...window.ZXing};const{BrowserMultiFormatReader:b,NotFoundException:v}=w;const D={audio:false,video:{height:{min:480,ideal:960,max:1440},aspectRatio:1.333333333,facingMode:"environment"}};let B=_=class e extends t.default{constructor(){super();this._codeReader=new b}static async onDefine(){_.i18nBundle=await(0,r.getI18nBundle)("@ui5/webcomponents-fiori")}show(){if(this.loading){console.warn("Barcode scanning is already in progress.");return}if(!this._hasGetUserMedia()){this.fireEvent("scan-error",{message:"getUserMedia() is not supported by your browser"});return}this.loading=true;this._getUserPermission().then(()=>this._showDialog()).catch(e=>{this.fireEvent("scan-error",{message:e});this.loading=false})}close(){this._closeDialog();this.loading=false}_hasGetUserMedia(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}_getUserPermission(){return navigator.mediaDevices.getUserMedia(D)}async _getDialog(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-dialog]")}async _getVideoElement(){const e=await this.getStaticAreaItemDomRef();return e.querySelector(".ui5-barcode-scanner-dialog-video")}async _showDialog(){this.dialog=await this._getDialog();this.dialog.show()}_closeDialog(){if(this.dialog&&this.dialog.opened){this.dialog.close()}}_startReader(){this._decodeFromCamera()}async _resetReader(){const e=await this._getVideoElement();e.pause();this._codeReader.reset()}async _decodeFromCamera(){const e=await this._getVideoElement();this._codeReader.decodeFromVideoDevice(null,e,(e,t)=>{this.loading=false;if(e){this.fireEvent("scan-success",{text:e.getText(),rawBytes:e.getRawBytes()})}if(t&&!(t instanceof v)){this.fireEvent("scan-error",{message:t.message})}}).catch(e=>this.fireEvent("scan-error",{message:e.message}))}get _cancelButtonText(){return _.i18nBundle.getText(u.BARCODE_SCANNER_DIALOG_CANCEL_BUTTON_TXT)}get _busyIndicatorText(){return _.i18nBundle.getText(u.BARCODE_SCANNER_DIALOG_LOADING_TXT)}};y([(0,d.default)({type:Boolean})],B.prototype,"loading",void 0);B=_=y([(0,c.default)({tag:"ui5-barcode-scanner-dialog",languageAware:true,renderer:a.default,staticAreaTemplate:f.default,staticAreaStyles:[g.default],dependencies:[i.default,s.default,n.default]}),(0,l.default)("scan-success",{detail:{text:{type:String},rawBytes:{type:Object}}}),(0,l.default)("scan-error",{detail:{message:{type:String}}})],B);B.define();var O=B;e.default=O});
//# sourceMappingURL=BarcodeScannerDialog.js.map